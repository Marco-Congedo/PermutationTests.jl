<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Package tests · PermutationTests</title><meta name="title" content="Package tests · PermutationTests"/><meta property="og:title" content="Package tests · PermutationTests"/><meta property="twitter:title" content="Package tests · PermutationTests"/><meta name="description" content="Documentation for PermutationTests."/><meta property="og:description" content="Documentation for PermutationTests."/><meta property="twitter:description" content="Documentation for PermutationTests."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="PermutationTests logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="PermutationTests logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PermutationTests</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PermutationTests.jl</a></li><li><a class="tocitem" href="../about/">About</a></li><li><a class="tocitem" href="../PermutationTests/">Main Module</a></li><li><a class="tocitem" href="../univariate tests/">Univariate tests</a></li><li><a class="tocitem" href="../multiple comparisons tests/">Multiple comparisons tests</a></li><li class="is-active"><a class="tocitem" href>Package tests</a><ul class="internal"><li><a class="tocitem" href="#Code-tests"><span>Code tests</span></a></li><li><a class="tocitem" href="#Benchmarks"><span>Benchmarks</span></a></li><li><a class="tocitem" href="#Error-Control"><span>Error Control</span></a></li><li><a class="tocitem" href="#Power"><span>Power</span></a></li></ul></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="../statistics/">Statistics</a></li><li><a class="tocitem" href="../test statistics/">Test statistics</a></li><li><a class="tocitem" href="../create your own test/">Create your own test</a></li><li><a class="tocitem" href="../chose a test/">Chose a Test</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Package tests</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Package tests</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/PermutationTests.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/master/docs/src/package tests.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Package-tests"><a class="docs-heading-anchor" href="#Package-tests">Package tests</a><a id="Package-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Package-tests" title="Permalink"></a></h1><p>The code units pointed to in this page should be run within the general julia environment once <em>PermutationTests.jl</em> has been <a href="../#Installation">installed</a>.</p><hr/><h2 id="Code-tests"><a class="docs-heading-anchor" href="#Code-tests">Code tests</a><a id="Code-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Code-tests" title="Permalink"></a></h2><p>For testing the main functions of the package, run the <code>runtests.jl</code> unit, located in the  <a href="https://github.com/Marco-Congedo/PermutationTests.jl/tree/master/test">test</a> folder.</p><hr/><h2 id="Benchmarks"><a class="docs-heading-anchor" href="#Benchmarks">Benchmarks</a><a id="Benchmarks-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmarks" title="Permalink"></a></h2><p>Multiple comparison tests are multi-threaded. In general <em>PermutationTests.jl</em> is very fast; you may expect to wait less then a second to get the result of a multiple comparison correlation test involving 20000 hypotheses with samples of 20 observations each.</p><p>For running benchmarks on your computer use the <code>benchmarks.jl</code> unit located in the <a href="https://github.com/Marco-Congedo/PermutationTests.jl/tree/master/src/extras/benchmarks">src\extras\benchmarks</a> folder.</p><p>In that folder you will also find a pdf showing plots and tables generated by the unit, as it is currently  published.</p><hr/><div class="admonition is-success"><header class="admonition-header">Benchmarks hardware</header><div class="admonition-body"><p>Here below are the results obtained running the unit on a regular laptop running under Windows 10 equipped with a <em>Intel Core i7-8650U CPU @ 1.90GHz</em> and <em>32Go of RAM</em>.</p></div></div><p>For <strong>univariate tests</strong>, the figure below reports the minimum execution time for approximate tests using 10000 random permutations for various numbers of observations (e.g., subjects):</p><p><img src="../assets/benchmarks_uni.png" alt="Figure 2"/></p><p><em>Legend: IS=independent samples, RM=repeated measures, 1S=one-sample, St.=Student</em></p><p>We see that with 9000 observations, all tests execute within 4s, with the correlation/trend test, all types of t-tests, the McNemar test and the sign test executing within 1s. </p><hr/><p>For <strong>multiple comparisons tests</strong>, the figure below reports the minimum execution time for approximate tests using 10000 random permutations for 12 observations and various numbers of hypotheses:</p><p><img src="../assets/benchmarks_multComp.png" alt="Figure 3"/></p><p><em>Legend: IS=independent samples, RM=repeated measures, 1S=one-sample, St.=Student</em></p><p>We see that for sample size = 12 and 1000 hypotheses, the correlation and t-test for independent samples complete in about 200ms, while the other tests need about 2 to 8 seconds.</p><hr/><h2 id="Error-Control"><a class="docs-heading-anchor" href="#Error-Control">Error Control</a><a id="Error-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Control" title="Permalink"></a></h2><p>All univariate statistical hypothesis tests must control the  <a href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors">type I error</a> under the null hypotheses.</p><p>As explained in the <a href="../#Overview">overview</a>, the multiple comparisons tests implemented in <em>PermutationTests.jl</em> control the <a href="https://en.wikipedia.org/wiki/Family-wise_error_rate">(FWE)</a> rate under the global null hypothesis.</p><p>The <code>errorControl.jl</code> unit located in the <a href="https://github.com/Marco-Congedo/PermutationTests.jl/tree/master/src/extras/errorControl">src\extras\errorControl</a> folder runs simulations to verify these errors for all implemented tests. </p><p>In that folder you will also find a pdf showing the plots of the data the unit produces as it is currently  published.</p><p>As an example, in the figure below the orange line is the p-p plot of the observed p-values versus the expected p-values under the null hypothesis. The plot has been obtained with 1000 simulations of a <strong>univariate Pearson correlation test</strong> by data permutation with four sample sizes (<span>$N$</span>). The blue line traces the expected  p-values (control level):</p><p><img src="../assets/errror_uni_corr.png" alt="Figure 4"/></p><hr/><p>For <strong>multivariate permutation tests</strong>, the figure below show the proportion of rejected hypotheses obtained  across 100 simulations for several tests and 2, 5, 10 or 100 hypotheses tested simultaneously.  The FWE is controlled if the proportion is inferior to the nominal FWE level of the test, 0.05 for this simulation.</p><p><img src="../assets/error_multComp.png" alt="Figure 5"/></p><hr/><h2 id="Power"><a class="docs-heading-anchor" href="#Power">Power</a><a id="Power-1"></a><a class="docs-heading-anchor-permalink" href="#Power" title="Permalink"></a></h2><p>The power of a statstical hypothesis test is the probability that the test correctly rejects the null  hypothesis when it is false. It depends on many factors, including the sample size, the effect size, the characteristics of the test and more.</p><p>The <code>power.jl</code> unit located in the <a href="https://github.com/Marco-Congedo/PermutationTests.jl/tree/master/src/extras/power">src\extras\power</a> folder contains example code to estimate the power of two univariate and multiple comparisons tests implemented in <em>PermutationTests.jl</em>. The code can be expanded for the other implemented tests as well as for running the power analysis with different parameters.</p><p>In that folder you will also find a pdf showing the plots of the data the unit, as it is currently  published, produces.</p><p>As an example, the figure below compares the power of the <strong>univariate Pearson correlation test</strong> to its parametric counterpart, which is the usual test for correlation or of the slope of a regression line  (see section &quot;Slope of a regression line&quot; <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test">here</a>). The power is estimated for four sample size values (<span>$N$</span>) using random Gaussian data and 1000 simulations.</p><p><img src="../assets/power_uni_cor.png" alt="Figure 6"/></p><p>We see that the power of the permutation and parametric test is very close for all sample size values.</p><hr/><p>For <strong>multivariate permutation tests</strong>, the figure below show the proportion of truly rejected hypotheses  (number of rejected hypotheses divided by the number of false hypotheses) of the t-test for  indipendent samples ( 8 subjects per group) obtained with 100 simulations when testing 5, 20 and 100 hypotheses simultaneously (<span>$M$</span>).  In these simulations, multivariate Gaussian data is generated under <span>$H_0$</span> for half of the hypotheses and for the remaining half with an effect size allowing an expected p-value equal to 0.01 for each hypothesis tested separatedly with the parametric test. The hypotheses have geen generated uncorrelated and with three different degrees of uniform correlation such that the expected p-value of the correlation <span>$𝔼p(ρ)$</span> is equal to 1, 0.1 or 0.01. See the <a href="../#Preamble">preamble</a> for a discussion on correlation among hypotheses. </p><p><img src="../assets/power_multComp.png" alt="Figure 7"/></p><p>We see that, on the average of all simulations, the multiple comparisons permutation max-t test  implemented in this package is always more powerful than the Bonferroni correction procedure, it does not matter the number of hypotheses and whether the hypotheses are correlated or not.  The advantage of the permutation approach increases as the correlation among variables (ρ) increases (hence its expected p-value decreases).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multiple comparisons tests/">« Multiple comparisons tests</a><a class="docs-footer-nextpage" href="../tools/">Tools »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 1 July 2024 14:05">Monday 1 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
