<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple comparisons tests · PermutationTests</title><meta name="title" content="Multiple comparisons tests · PermutationTests"/><meta property="og:title" content="Multiple comparisons tests · PermutationTests"/><meta property="twitter:title" content="Multiple comparisons tests · PermutationTests"/><meta name="description" content="Documentation for PermutationTests."/><meta property="og:description" content="Documentation for PermutationTests."/><meta property="twitter:description" content="Documentation for PermutationTests."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="PermutationTests logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="PermutationTests logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PermutationTests</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PermutationTests.jl</a></li><li><a class="tocitem" href="../about/">About</a></li><li><a class="tocitem" href="../PermutationTests/">Main Module</a></li><li><a class="tocitem" href="../univariate tests/">Univariate tests</a></li><li class="is-active"><a class="tocitem" href>Multiple comparisons tests</a><ul class="internal"><li><a class="tocitem" href="#Correlation-test"><span>Correlation test</span></a></li><li><a class="tocitem" href="#Trend-test"><span>Trend test</span></a></li><li><a class="tocitem" href="#Point-bi-serial-correlation-test"><span>Point bi-serial correlation test</span></a></li><li><a class="tocitem" href="#Student&#39;s-t-test-for-independent-samples"><span>Student&#39;s t-test for independent samples</span></a></li><li><a class="tocitem" href="#1-way-ANOVA-for-independent-samples"><span>1-way ANOVA for independent samples</span></a></li><li><a class="tocitem" href="#Chi-squared-test"><span>Chi-squared test</span></a></li><li><a class="tocitem" href="#Fisher-exact-test"><span>Fisher exact test</span></a></li><li><a class="tocitem" href="#Student&#39;s-t-test-for-repeated-measures"><span>Student&#39;s t-test for repeated measures</span></a></li><li><a class="tocitem" href="#1-way-ANOVA-for-repeated-measures"><span>1-way ANOVA for repeated measures</span></a></li><li><a class="tocitem" href="#Cochran-Q-test"><span>Cochran Q test</span></a></li><li><a class="tocitem" href="#McNemar-test"><span>McNemar test</span></a></li><li><a class="tocitem" href="#One-sample-Student&#39;s-t-test"><span>One-sample Student&#39;s t-test</span></a></li><li><a class="tocitem" href="#Sign-test"><span>Sign test</span></a></li></ul></li><li><a class="tocitem" href="../package tests/">Package tests</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="../statistics/">Statistics</a></li><li><a class="tocitem" href="../test statistics/">Test statistics</a></li><li><a class="tocitem" href="../pCombination/">p-value combinations</a></li><li><a class="tocitem" href="../create your own test/">Create your own test</a></li><li><a class="tocitem" href="../chose a test/">Chose a Test</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Multiple comparisons tests</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple comparisons tests</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/PermutationTests.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/master/docs/src/multiple comparisons tests.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Multiple-comparisons-tests"><a class="docs-heading-anchor" href="#Multiple-comparisons-tests">Multiple comparisons tests</a><a id="Multiple-comparisons-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-comparisons-tests" title="Permalink"></a></h1><p>With a multiple comparisons test <span>$M$</span> null hypotheses are tested simultaneously.  By deriving the null distribution with the max-statistic approach, the following permutation tests control the family-wise error <a href="https://en.wikipedia.org/wiki/Family-wise_error_rate">(FWE)</a> rate, that is, the probability to commit one or more <a href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors">Type I error</a> at the nominal level:</p><hr/><h4 id="Multiple-comparisons-test-functions"><a class="docs-heading-anchor" href="#Multiple-comparisons-test-functions">Multiple comparisons test functions</a><a id="Multiple-comparisons-test-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-comparisons-test-functions" title="Permalink"></a></h4><table><tr><th style="text-align: left">test</th><th style="text-align: left">use function</th><th style="text-align: left">alias</th></tr><tr><td style="text-align: left">Pearson correlation</td><td style="text-align: left"><a href="#PermutationTests.correlationMcTest"><code>correlationMcTest</code></a></td><td style="text-align: left"><code>rMcTest</code></td></tr><tr><td style="text-align: left">Trend correlation</td><td style="text-align: left"><a href="#PermutationTests.trendMcTest"><code>trendMcTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Point bi-serial correlation</td><td style="text-align: left"><a href="#PermutationTests.pointBiSerialMcTest"><code>pointBiSerialMcTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Student&#39;s t for independent samples</td><td style="text-align: left"><a href="#PermutationTests.studentMcTestIS"><code>studentMcTestIS</code></a></td><td style="text-align: left"><code>tMcTestIS</code></td></tr><tr><td style="text-align: left">1-way ANOVA for independent samples</td><td style="text-align: left"><a href="#PermutationTests.anovaMcTestIS"><code>anovaMcTestIS</code></a></td><td style="text-align: left"><code>fMcTestIS</code></td></tr><tr><td style="text-align: left">Chi-squared</td><td style="text-align: left"><a href="#PermutationTests.chiSquaredMcTest"><code>chiSquaredMcTest</code></a></td><td style="text-align: left"><code>Χ²McTest</code></td></tr><tr><td style="text-align: left">Fisher exact</td><td style="text-align: left"><a href="#PermutationTests.fisherExactMcTest"><code>fisherExactMcTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Student&#39;s t for repeated measures</td><td style="text-align: left"><a href="#PermutationTests.studentMcTestRM"><code>studentMcTestRM</code></a></td><td style="text-align: left"><code>tMcTestRM</code></td></tr><tr><td style="text-align: left">1-way ANOVA for repeated measures</td><td style="text-align: left"><a href="#PermutationTests.anovaMcTestRM"><code>anovaMcTestRM</code></a></td><td style="text-align: left"><code>fMcTestRM</code></td></tr><tr><td style="text-align: left">Cochran Q</td><td style="text-align: left"><a href="#PermutationTests.cochranqMcTest"><code>cochranqMcTest</code></a></td><td style="text-align: left"><code>qMcTest</code></td></tr><tr><td style="text-align: left">McNemar</td><td style="text-align: left"><a href="#PermutationTests.mcNemarMcTest"><code>mcNemarMcTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">One-sample Student&#39;s t</td><td style="text-align: left"><a href="#PermutationTests.studentMcTest1S"><code>studentMcTest1S</code></a></td><td style="text-align: left"><code>tMcTest1S</code></td></tr><tr><td style="text-align: left">Sign test</td><td style="text-align: left"><a href="#PermutationTests.signMcTest"><code>signMcTest</code></a></td><td style="text-align: left"></td></tr></table><p>You may also find useful the tests we have created as examples of how to create new tests:</p><table><tr><th style="text-align: left">Test</th></tr><tr><td style="text-align: left"><a href="../create your own test/#Example-2:-Post-hoc-tests-for-1-way-repeated-measures-ANOVA">Post-hoc tests for 1-way repeated-measures ANOVA</a></td></tr><tr><td style="text-align: left"><a href="../create your own test/#Example-6:-multiple-comparisons-Chatterjee-correlation">Chatterjee correlation</a></td></tr><tr><td style="text-align: left"><a href="../create your own test/#Example-8:-multiple-comparisons-distance-correlation">Distance correlation</a></td></tr></table><hr/><p>For creating other tests, see <a href="../create your own test/#Create-your-own-test">Create your own test</a>.</p><p>For univariate tests, see <a href="../univariate tests/#Univariate-tests">Univariate tests</a>.</p><hr/><h4 id="Common-kwargs-for-multiple-comparisons-tests"><a class="docs-heading-anchor" href="#Common-kwargs-for-multiple-comparisons-tests">Common kwargs for multiple comparisons tests</a><a id="Common-kwargs-for-multiple-comparisons-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Common-kwargs-for-multiple-comparisons-tests" title="Permalink"></a></h4><p>The following optional keyword arguments are common to all multiple comparisons test functions:</p><ul><li><code>direction</code>: an instance of <a href="../PermutationTests/#TestDirection">TestDirection</a>, either <code>Right()</code>, <code>Left()</code> or <code>Both()</code>. The default is <code>Both()</code>. </li><li><code>nperm</code>: an integer providing the number of random permutations to be used for an approximate test. It defaults to <code>20000</code>. </li><li><code>switch2rand</code>: an integer setting the upper limit of permutations to be listed exhaustively. It defaults to <code>1e8</code>. If the number of possible permutations exceeds <code>switch2rand</code>, the approximate test with <code>nperm</code> random permutations will be performed, otherwise an exact test with all possible permutations will be performed. In order to force an approximate test, set <code>switch2rand</code> to a small integer such as <code>1</code>. In order to know the number of possible permutations, see <a href="../tools/#PermutationTests.nrPerms"><code>nrPerms</code></a>. </li><li><code>seed</code>: an integer. It applies only to approximate tests. Set to <code>0</code> to use a random seed for generating random permutations. Any natural number results instead in a reproducible test. It defaults to <code>1234</code>. </li><li><code>verbose</code>: a boolean. Print some information in the REPL while running the test. Set to false if you run benchmarks. The default is <code>true</code>.</li><li><code>stepdown</code> : a boolean. If true (default) the step-down procedure is used. This is at least as powerfu as the standard procedure and still controls the FWE.</li><li><code>fwe</code> : a real number in (0, 1). This is used by the step-down prcedure to control the family-wise error (FWE) rate at this level. By default it is 0.05.</li><li><code>threaded</code> : a boolean. If true (default) some computations are multi-threaded if the product of the number of hypotheses, observations, and permutations exceed 500 millions.</li></ul><hr/><h4 id="Multiple-comparisons-tests-API"><a class="docs-heading-anchor" href="#Multiple-comparisons-tests-API">Multiple comparisons tests API</a><a id="Multiple-comparisons-tests-API-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-comparisons-tests-API" title="Permalink"></a></h4><hr/><h2 id="Correlation-test"><a class="docs-heading-anchor" href="#Correlation-test">Correlation test</a><a id="Correlation-test-1"></a><a class="docs-heading-anchor-permalink" href="#Correlation-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.correlationMcTest" href="#PermutationTests.correlationMcTest"><code>PermutationTests.correlationMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function correlationMcTest(x::UniData, Y::UniDataVec;
            direction::TestDir = Both(),
            switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)), 
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true, 
            #
            standardized::Bool = false,
            #
            stepdown::Bool = true,
            fwe::Float64 = 0.05,
            threaded::Bool = Threads.nthreads()&gt;=4) where TestDir &lt;: TestDirection</code></pre><p>Multiple comparisons <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#Testing_using_Student&#39;s_t-distribution">Pearson product-moment correlation test</a>  by data permutation. </p><p>Run <span>$M$</span> correlation tests simultaneously.  The input data are a fixed vector <code>x</code> and <span>$M$</span> vectors given as <code>Y</code>, a vector of <span>$M$</span> vectors <span>$y_1,...,y_M$</span>. </p><p><code>x</code> and all vectors in <code>Y</code> must have equal length. </p><p>The <span>$M$</span> null hypotheses have form </p><p><span>$H_0(m):r_{(x, y_m)}=0, \quad m=1...M$</span>, </p><p>where <span>$r_{x,y_m}$</span> is the Pearson correlation coefficient between vector <code>x</code> and the <span>$m^{th}$</span> vector of <code>Y</code>.</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code>, see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>.</p><p>If <code>standardized</code> is true, both <code>x</code> and all vectors of <code>Y</code> are assumed standardized (zero mean and unit standard deviation). With standardized input data the test can be executed faster as in this case the cross-product is actually the correlation.  If <code>standardized</code> is false, the data will be standardized to execute a faster test.</p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per  <em>univariate version</em> <a href="../univariate tests/#PermutationTests.correlationTest"><code>correlationTest</code></a></p><p><em>Aliases:</em> <code>rMcTest</code>, <a href="#PermutationTests.trendMcTest"><code>trendMcTest</code></a> </p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=10; # number of observations
M=100; # number of tests
x=randn(N);
Y=[randn(N) for i=1:M];
t=rMcTest(x, Y) # bi-directional test</code></pre><pre><code class="language-julia hljs">tR=rMcTest(x, Y; direction=Right()) # right-directional test
tL=McTest(x, Y; direction=Left()) # left-directional test
tMC=rMcTest(x, Y; switch2rand=1) # Force a monte carlo test
# Force a monte carlo test and performs 50K permutations
t5K=rMcTest(x, Y; switch2rand=1, nperm= 50_000) 
tnoSD=rMcTest(x, Y; stepdown=false) # don&#39;t do stepdown
tnoMT=rMcTest(x, Y; threaded=false) # don&#39;t run it multithreaded
t001=rMcTest(x, Y; fwe=0.01) # stepdown rejects at 0.01 level instead of 0.05</code></pre><p><strong>Similar tests</strong></p><p>See <a href="../univariate tests/#PermutationTests.correlationTest">correlationTest</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L64-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.correlationMcTest!" href="#PermutationTests.correlationMcTest!"><code>PermutationTests.correlationMcTest!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function correlationMcTest!(&lt;same args and kwargs as `correlationMcTest`&gt;)</code></pre><p>As <a href="#PermutationTests.correlationMcTest"><code>correlationMcTest</code></a>, but <code>x</code> is overwritten if <code>standardized</code> is true. </p><p><em>Aliases:</em> <code>rMcTest!</code>, <a href="#PermutationTests.trendMcTest!"><code>trendMcTest!</code></a></p><p><em>Univariate version:</em>  <a href="../univariate tests/#PermutationTests.correlationTest!"><code>correlationTest!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L162-L173">source</a></section></article><hr/><h2 id="Trend-test"><a class="docs-heading-anchor" href="#Trend-test">Trend test</a><a id="Trend-test-1"></a><a class="docs-heading-anchor-permalink" href="#Trend-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.trendMcTest" href="#PermutationTests.trendMcTest"><code>PermutationTests.trendMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function trendMcTest(&lt;same args and kwargs as correlationMcTest&gt;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L201-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.trendMcTest!" href="#PermutationTests.trendMcTest!"><code>PermutationTests.trendMcTest!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function trendMcTest!(&lt;same args and kwargs as correlationMcTest!&gt;)</code></pre><p>Actually aliases of <a href="#PermutationTests.correlationMcTest"><code>correlationMcTest</code></a> and <a href="#PermutationTests.correlationMcTest!"><code>correlationMcTest!</code></a>, respectively. </p><p><code>x</code> is any specified trend (linear, polynomial, exponential, logarithmic, trigonometric, ...) and <code>Y</code> holds the observed data. A multiple comparison Pearson product-moment correlation  test between <code>x</code> and all <span>$M$</span> vectors in <code>Y</code> is then carried out. </p><p>Directional tests, permutation scheme and number of permutations for exact tests: as per  <em>univariate versions</em> <a href="../univariate tests/#PermutationTests.trendTest"><code>trendTest</code></a> or <a href="../univariate tests/#PermutationTests.trendTest!"><code>trendTest!</code></a></p><p>Both methods return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
# We are goint to test an upward linear trend
N=10
M=100
x=Float64.(collect(Base.OneTo(N))) # [1, 2,..., N]
# out of the M vectors created here below, only one has a significant correlation
Y=[[1., 2., 4., 3., 5., 6., 7., 8., 10., 9.], ([randn(N) for m=1:M-1]...)];
# Since we expect an upward linear trend, the correlation is expected to be positive,
# hence we use a right-directional test to increase the power of the test.
t = trendMcTest(x, Y; direction=Right()) </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L208-L238">source</a></section></article><hr/><h2 id="Point-bi-serial-correlation-test"><a class="docs-heading-anchor" href="#Point-bi-serial-correlation-test">Point bi-serial correlation test</a><a id="Point-bi-serial-correlation-test-1"></a><a class="docs-heading-anchor-permalink" href="#Point-bi-serial-correlation-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.pointBiSerialMcTest" href="#PermutationTests.pointBiSerialMcTest"><code>PermutationTests.pointBiSerialMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function pointBiSerialMcTest(&lt;same args and kwargs as `studentMcTestIS`&gt;)</code></pre><p>Actually an alias for <a href="#PermutationTests.studentMcTestIS"><code>studentMcTestIS</code></a>.</p><p>Run <span>$M$</span> <a href="https://en.wikipedia.org/wiki/Point-biserial_correlation_coefficient">point bi-serial correlation tests</a> simultaneously. The correlations are between the <span>$M$</span> input data vectors <span>$y_1,...,y_M$</span> given as argument <code>Y</code>,  all holding <span>$N=N_1+N_2$</span> elements, and a vector <span>$x$</span>, internally created, with the first <span>$N_1$</span> elements equal to <code>1</code> and the remaining <span>$N_2$</span> elements equal to <code>2</code>.</p><p>If you need to use other values for the dicothomous variable <span>$x$</span> or a different order for its elements,  use <a href="#PermutationTests.correlationMcTest"><code>correlationMcTest</code></a> instead. </p><p>The <span>$M$</span> null hypotheses have form </p><p><span>$H_0(m): b_{(x,y_m)}=0, \quad m=1...M$</span>,</p><p>where <span>$b_{(x,y_m)}$</span> is the point bi-serial correlation between <span>$y_m$</span> (the <span>$m^{th}$</span> input data vectors in <code>Y</code>)  and the internally created vector <span>$x$</span>.</p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
ns=[4, 6]; # N1=4, N2=6
N=sum(ns); # number of observations

Y = [rand(N) for m=1:M]; # some Gaussian data as example
# implicitly, the point bi serial correlation is between 
# y1,...,yM and x=[1, 1, 1, 1, 2, 2, 2, 2, 2, 2]
t=pointBiSerialMCTest(Y, ns) # by default the test is bi-directional</code></pre><pre><code class="language-julia hljs">tR=pointBiSerialMCTest(Y, ns; direction=Right()) # right-directional test
tL=pointBiSerialMCTest(Y, ns; direction=Left()) # left-directional test</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L581-L623">source</a></section></article><hr/><h2 id="Student&#39;s-t-test-for-independent-samples"><a class="docs-heading-anchor" href="#Student&#39;s-t-test-for-independent-samples">Student&#39;s t-test for independent samples</a><a id="Student&#39;s-t-test-for-independent-samples-1"></a><a class="docs-heading-anchor-permalink" href="#Student&#39;s-t-test-for-independent-samples" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentMcTestIS" href="#PermutationTests.studentMcTestIS"><code>PermutationTests.studentMcTestIS</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function studentMcTestIS(Y::UniDataVec, ns::IntVec;
                direction::TestDir = Both(),
                switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)),
                nperm::Int = 20_000, 
                seed::Int = 1234, 
                verbose::Bool = true,
                #
                stepdown::Bool = true,
                fwe::Float64 = 0.05,
                threaded::Bool = Threads.nthreads()&gt;=4,
                asPearson::Bool = true) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L374-L389">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function studentMcTestIS(Yvec::UniDataVec²; &lt;same kwargs&gt;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L420-L425">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (3)
function studentMcTestIS(X::UniDataVec, Y::UniDataVec; &lt;same kwargs&gt;)</code></pre><p><strong>METHOD (1)</strong></p><p>Multiple comparisons <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test#Independent_(unpaired)_samples">Student&#39;s t-test for independent samples</a>  by data permutation. </p><p>Run <span>$M$</span> t-tests simultaneously. Given <span>$M$</span> hypotheses with <span>$N=N_1+N_2$</span> observations for two groups each,  the <span>$M$</span> null hypotheses have form</p><p><span>$H_0(m): μ_{m1}=μ_{m2}, \quad m=1...M$</span>,</p><p>where <span>$μ_{m1}$</span> and <span>$μ_{m2}$</span> are the mean of group 1 and group 2, respectively, for the <span>$m^{th}$</span>hypothesis. </p><p>For a bi-directional test, this t-test is equivalent to the 1-way ANOVA for two independent samples. However, in contrast to the ANOVA, it can be directional. </p><p><code>ns</code> is a vector of integers holding the group numerosity <span>$N_1, N_2$</span> (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>. </p><p>If <code>asPearson</code> is true(default), the test is run as an equivalent version of a Pearson correlation test. This is in general advantageous for multiple comparison tests, especially if approximate (see the <a href="../package tests/#Benchmarks">benchmarks</a>). If you seek best performance for exact tests, benchmark the speed of the test with <code>asPearson</code> set to true and to false to see what version is faster for your data. </p><div class="admonition is-info" id="nota-50d0c6cfc32b5f00"><header class="admonition-header">nota<a class="admonition-anchor" href="#nota-50d0c6cfc32b5f00" title="Permalink"></a></header><div class="admonition-body"><p>If <code>asPearson</code> is true, the <code>.stat</code> field of the test result will actually be <code>CrossProd()</code>, as the data will be standardized before running the test. See <a href="../univariate tests/#PermutationTests.correlationTest"><code>correlationTest</code></a>.</p></div></div><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.studentTestIS"><code>studentTestIS</code></a></p><p><em>Aliases:</em> <code>tTestMcIS</code>, <a href="#PermutationTests.pointBiSerialMcTest"><code>pointBiSerialMcTest</code></a></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><strong>METHOD (2)</strong></p><p>As method (1), but input data <code>Yvec</code> is a vector containing <span>$M$</span> pairs of vector of arbitrary length,  holding in the natural order the data corresponding to the <span>$m^{th}$</span> hypothesis for group 1 and group 2, respectively.</p><p><strong>METHOD (3)</strong></p><p>As method (1), but input data <code>X</code> and <code>Y</code> holds <span>$M$</span> vectors of observations each, <code>X</code> corresponding to data  for group 1 and <code>Y</code> corresponding to data for group 2.  The <span>$M$</span> vectors in <code>X</code> must have all the same length (<span>$N_1$</span>), so must the <span>$M$</span> vectors in <code>Y</code> (<span>$N_2$</span>). </p><p><em>Examples</em></p><pre><code class="language-julia hljs"># (1)
using PermutationTests
M=100 # number of hypotheses
ns=[4, 5] # number of observations in group 1 and group 2 (N1 and N2)
N=sum(ns) # total number of observations
Yvec = [[randn(n) for n in ns] for m=1:M]; # some random Gaussian data for example 
Y=[vcat(yvec...) for yvec in Yvec];
t = tMcTestIS(Y, ns) # by default the test is bi-directional

# Force an approximate test with 10000 random permutations
tapprox = tMcTestIS(Y, ns; switch2rand=1, nperm=10000) 
tR=tMcTestIS(Y, ns; direction=Right()) # right-directional test
tL=tMcTestIS(Y, ns; direction=Left()) # left-directional test

# with a bi-directional test, t is equivalent to a 1-way ANOVA for independent samples
tanova= fMcTestIS(Y, ns) 
println(sum(abs.(t.p - tanova.p)) ≈ 0. ? &quot;OK&quot; : &quot;error&quot;)

# do not run it using the CrossProd test statistic
tcor = tMcTestIS(Y, ns; asPearson=false) 

# in method (2) only the way the input data is formatted is different 
t2 = tMcTestIS(Yvec)
println(sum(abs.(t.p - t2.p)) ≈ 0. ? &quot;OK&quot; : &quot;error&quot;)

# in method (3) also, only the way the input data is formatted is different 
t3 = tMcTestIS([Yvec[m][1] for m=1:M], [Yvec[m][2] for m=1:M])
println(sum(abs.(t.p - t3.p)) ≈ 0. ? &quot;OK&quot; : &quot;error&quot;)</code></pre><p><strong>Similar tests</strong></p><p>See <a href="../univariate tests/#PermutationTests.studentTest1S"><code>studentTest1S</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L458-L548">source</a></section></article><hr/><h2 id="1-way-ANOVA-for-independent-samples"><a class="docs-heading-anchor" href="#1-way-ANOVA-for-independent-samples">1-way ANOVA for independent samples</a><a id="1-way-ANOVA-for-independent-samples-1"></a><a class="docs-heading-anchor-permalink" href="#1-way-ANOVA-for-independent-samples" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.anovaMcTestIS" href="#PermutationTests.anovaMcTestIS"><code>PermutationTests.anovaMcTestIS</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function anovaMcTestIS(Y::UniDataVec, ns::IntVec;
                direction::TestDir = Both(),
                switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)),
                nperm::Int = 20_000, 
                seed::Int = 1234, 
                verbose::Bool = true,
                #
                stepdown::Bool = true,
                fwe::Float64 = 0.05,
                threaded::Bool = Threads.nthreads()&gt;=4) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L243-L257">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function anovaMcTestIS(𝐘vec::UniDataVec²; &lt;same kwargs&gt;)</code></pre><p><strong>METHOD (1)</strong></p><p>Multiple comparisons <a href="https://en.wikipedia.org/wiki/One-way_analysis_of_variance">1-way analysis of variance (ANOVA) for independent samples</a>  by data permutation. </p><p>Run <span>$M$</span> ANOVAs simultaneously. The Input data is given as a vector <code>Y</code> holding <span>$M$</span> vectors <span>$𝐲1,...,𝐲M$</span> concatenating all observations, that is, holding each <span>$N=N_1+...+N_K$</span> observations  for <span>$K&gt;2$</span> independent samples (groups). The observations are ordered with group 1 first, then group 2,..., finally group K. Note that the group numerosity <span>$N_1,...,N_K$</span> must be the same for all <span>$M$</span> hypotheses.  The only check performed is that the first vector in <code>Y</code> contains <code>sum(ns)</code> elements.</p><p>The <span>$M$</span> null hypotheses have form</p><p><span>$H_0(m): μ_{m1}= \ldots =μ_{mK}, \quad m=1...M$</span>,</p><p>where <span>$μ_{mk}$</span> is the mean of the <span>$k^{th}$</span> group for the <span>$m^{th}$</span> hypothesis.</p><p><code>ns</code> is a vector of integers holding the group numerosity <span>$N_1,...,N_K$</span> (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>.</p><p>Directional tests, permutation scheme and number of permutations for exact tests: as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a></p><p><em>Alias:</em> <code>fMcTestIS</code></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><strong>METHOD (2)</strong></p><p>As method (1), but input data <code>Yvec</code> is a vector holding <span>$M$</span> vectors of K vectors of  observations for group 1,..., group K. </p><p><em>Examples</em></p><pre><code class="language-julia hljs"># method (1)
using PermutationTests
ns=[3, 4, 5] # number of observations in group 1, 2 and 3
M=10 # number of hypotheses
Yvec = [[randn(n) for n in ns] for m=1:M]; # some random Gaussian data for example 
t = fMcTestIS([vcat(y...) for y in Yvec], ns) # ANOVA tests are always bi-directional

# Force an approximate test with 5000 random permutations
tapprox = fMcTestIS([vcat(y...) for y in Yvec], ns; switch2rand=1, nperm=5000) 

# in method (2) only the way the input data is formatted is different 
t2 = fMcTestIS(Yvec)
# of course, method (1) and (2) give the same p-values
println(sum(abs.(t.p-t2.p))≈0. ? &quot;OK&quot; : &quot;error&quot;) </code></pre><p><strong>Similar tests</strong></p><p>See <a href="../univariate tests/#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L281-L344">source</a></section></article><hr/><h2 id="Chi-squared-test"><a class="docs-heading-anchor" href="#Chi-squared-test">Chi-squared test</a><a id="Chi-squared-test-1"></a><a class="docs-heading-anchor-permalink" href="#Chi-squared-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.chiSquaredMcTest" href="#PermutationTests.chiSquaredMcTest"><code>PermutationTests.chiSquaredMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function chiSquaredMcTest(tables::AbstractVector{Matrix{I}};
            direction::TestDir = Both(),
            switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)), 
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,            
            #
            stepdown::Bool = true,
            fwe::Float64 = 0.05,
            threaded::Bool = Threads.nthreads()&gt;=4,
            asPearson::Bool = true) 
                    where {I &lt;: Int, TestDir &lt;: TestDirection}</code></pre><p>Multiple comparisons <a href="https://en.wikipedia.org/wiki/Chi-squared_test">chi-squared</a> (<span>$\chi^2$</span>) permutation test  for <span>$2 \cdot K$</span> contingency tables, where <span>$K$</span> is ≥2.  It tests simultaneously <span>$M$</span> contingency tables, which must all have same dimension and same column sums.</p><p>The <span>$M$</span> null hypotheses have form </p><p><span>$H_0(m): O_m=E_m$</span>, \quad m=1...M``,</p><p>where <span>$O_m$</span> and <span>$E_m$</span> are the observed and expected frequencies of the <span>$m^{th}$</span>contingency table.</p><p><code>tables</code> is a vector of <span>$M$</span> contingency tables. See <a href="../univariate tests/#PermutationTests.chiSquaredTest"><code>chiSquaredTest</code></a> for more explanations.</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>.</p><p>For <span>$K=2$</span> this function calls <a href="#PermutationTests.studentMcTestIS"><code>studentMcTestIS</code></a> and pass to it also argument <code>asPearson</code>, otherwise calls <a href="#PermutationTests.anovaMcTestIS"><code>anovaMcTestIS</code></a> and argument <code>asPearson</code> is ignored.</p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.chiSquaredTest"><code>chiSquaredTest</code></a></p><p><em>Aliases:</em> <code>Χ²McTest</code>, <a href="#PermutationTests.fisherExactMcTest"><code>fisherExactMcTest</code></a></p><p>Return a [MultcompTest] structure.</p><div class="admonition is-warning" id="Warning-86e4ef6c60ca7d0e"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-86e4ef6c60ca7d0e" title="Permalink"></a></header><div class="admonition-body"><p>For <span>$K&gt;2$</span>, permutations of dicothomous tables may yield a null &quot;sum of squares within&quot;,  thus an infinite <em>F</em> statistic for the ANOVA. In this case the <code>.nulldistr</code> field of the  returned structure will contain some julia <code>Inf</code> elements. This does not apply for the univariate  version of the test (<a href="../univariate tests/#PermutationTests.chiSquaredTest"><code>chiSquaredTest</code></a>), as in this case an equivalent statistic for the  ANOVA is used (see <a href="../PermutationTests/#Statistic">Statistic</a>) and those statistics can never go to infinity. </p></div></div><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
tables=[[3 3 2; 0 0 1], [1 2 2; 2 1 1], [3 1 2; 0 2 1]];
t=Χ²McTest(tables) # the test is bi-directional

tables=[[6 1; 2 5], [4 1; 4 5], [5 2; 3 4]]
tR=fisherExactMcTest(tables; direction=Right()) 
# or tR=Χ²Test(tables; direction=Right())

# do not use PearsonR statistic
tR_=fisherExactMcTest(tables; direction=Right(), asPearson=false) 
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L629-L691">source</a></section></article><hr/><h2 id="Fisher-exact-test"><a class="docs-heading-anchor" href="#Fisher-exact-test">Fisher exact test</a><a id="Fisher-exact-test-1"></a><a class="docs-heading-anchor-permalink" href="#Fisher-exact-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.fisherExactMcTest" href="#PermutationTests.fisherExactMcTest"><code>PermutationTests.fisherExactMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function fisherExactMcTest(&lt;same args and kwargs as `chiSquaredMcTest`&gt;)</code></pre><p>Actually an alias for <a href="#PermutationTests.chiSquaredMcTest"><code>chiSquaredMcTest</code></a>. It can be used for 2x2 contingency tables. See <a href="../univariate tests/#PermutationTests.chiSquaredTest"><code>chiSquaredTest</code></a> for more explanations.</p><p><em>Univariate version:</em> <a href="../univariate tests/#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
tables=[[6 1; 2 5], [4 1; 4 5], [5 2; 3 4]];
tR=fisherExactMcTest(tables; direction=Right()) 
# or tR=Χ²Test(tables; direction=Right())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L717-L736">source</a></section></article><hr/><h2 id="Student&#39;s-t-test-for-repeated-measures"><a class="docs-heading-anchor" href="#Student&#39;s-t-test-for-repeated-measures">Student&#39;s t-test for repeated measures</a><a id="Student&#39;s-t-test-for-repeated-measures-1"></a><a class="docs-heading-anchor-permalink" href="#Student&#39;s-t-test-for-repeated-measures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentMcTestRM" href="#PermutationTests.studentMcTestRM"><code>PermutationTests.studentMcTestRM</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function studentMcTestRM(&lt;same args and kwargs as `studentMcTest1S`&gt;)</code></pre><p>Actually an alias for <a href="#PermutationTests.studentMcTest1S"><code>studentMcTest1S</code></a></p><p>In order to run a multiple comparisons t-test for repeated measure, use as data input the vector of  <span>$M$</span> vectors of differences across the two measurements (or treatments, time, etc.).</p><p>Do not change the <code>refmean</code> default value. See <a href="#PermutationTests.studentMcTest1S"><code>studentMcTest1S</code></a> for more details.</p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <a href="../univariate tests/#PermutationTests.studentTest1S"><code>studentTest1S</code></a></p><p><em>Univariate version:</em> <a href="../univariate tests/#PermutationTests.studentTestRM"><code>studentTestRM</code></a></p><p><em>Alias:</em> <code>tMcTestRM</code></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=10 # number of observation per treatment
M=100 # number of hypotheses

# suppose you have data as
Y1=[randn(N) for m=1:M]; # measurement 1
Y2=[randn(N) for m=1:M]; # measurement 2

# Let us compute the differences as
Y=[y1-y2 for (y1, y2) in zip(Y1, Y2)];
t=tMcTestRM(Y) # by default the test is bi-directional

tR=tMcTestRM(Y; direction=Both()) #  right-directional test
# if test tR is significant for some hypotheses, 
# for these hypotheses the mean of measurement 1 
# exceeds the mean of measurement 2.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L1176-L1216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentMcTestRM!" href="#PermutationTests.studentMcTestRM!"><code>PermutationTests.studentMcTestRM!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>(2) function studentMcTestRM!(&lt;same args and kwargs as <code>studentMcTest1S!</code>&gt;)</p><p>Actually an alias for <a href="#PermutationTests.studentMcTest1S!"><code>studentMcTest1S!</code></a>.</p><p><code>Y</code> is overwritten in the case of approximate (random permutations) tests.</p><p><em>Alias:</em> <code>tMcTestRM!</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L1222-L1232">source</a></section></article><hr/><h2 id="1-way-ANOVA-for-repeated-measures"><a class="docs-heading-anchor" href="#1-way-ANOVA-for-repeated-measures">1-way ANOVA for repeated measures</a><a id="1-way-ANOVA-for-repeated-measures-1"></a><a class="docs-heading-anchor-permalink" href="#1-way-ANOVA-for-repeated-measures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.anovaMcTestRM" href="#PermutationTests.anovaMcTestRM"><code>PermutationTests.anovaMcTestRM</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function anovaMcTestRM(Y::UniDataVec, ns::@NamedTuple{n::Int, k::Int};
            direction::TestDir = Both(),
            switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            #
            stepdown::Bool = true,
            fwe::Float64 = 0.05,
            threaded::Bool = Threads.nthreads()&gt;=4) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L741-L755">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function anovaMcTestRM(Yvec::UniDataVec²; &lt;same kwargs&gt;)</code></pre><p><strong>METHOD (1)</strong></p><p>Multiple comparison <a href="https://en.wikipedia.org/wiki/Repeated_measures_design#Repeated_measures_ANOVA">1-way analysis of variance (ANOVA) for repeated measures</a>  by data permutation. Given <span>$M$</span> hypotheses, each with <span>$K$</span> repeated measures (e.g., treatments, time, etc.) for each of <span>$N$</span> observation units  (e.g., subjects, blocks, etc.), the null hypotheses have form</p><p><span>$H_0(m): μ_{m1}= \ldots =μ_{mk}, \quad m=1...M$</span>,</p><p>where <span>$μ_{mk}$</span> is the mean of the <span>$k^{th}$</span> treatment for the <span>$m^{th}$</span> hypothesis. </p><p><code>Y</code> is a vector hoding <span>$M$</span> vectors, each one concatenaning the <span>$K$</span> treatments (treatment 1,..., treatment <span>$K$</span>)  for each observation for the <span>$m^{th}$</span> hypothesis in this order: the <span>$K$</span> treatments for observation 1, the <span>$K$</span> treatments for observation 2, ...,  the <span>$K$</span> treatments for observation <span>$N$</span>. Thus, <code>Y</code> holds <span>$M$</span> vectors of <span>$N \cdot K$</span> elements. </p><p><code>ns</code> is a julia <a href="https://docs.julialang.org/en/v1/manual/types/#Named-Tuple-Types">named tuple</a>  with form <code>(n=N, k=K)</code> (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>. </p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.anovaTestRM"><code>anovaTestRM</code></a></p><p><em>Alias:</em> <code>fTestMcRM</code></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><strong>METHOD (2)</strong></p><p>As (1), but <code>Yvec</code> is a vector of <span>$M$</span> vectors, each one holding <span>$N$</span> vectors holding each the <span>$K$</span> treatments for the <span>$n^{th}$</span>  subject (see examples below).</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># method (1)
using PermutationTests
N=6 # number of observation units per treatment
K=3 # number of treatments
M=10 # number of hypotheses
Yvec = [[randn(K) for n=1:N] for m=1:M]; # some random Gaussian data for example 
t = fMcTestRM([vcat(yvec...) for yvec in Yvec], (n=N, k=K)) 
# ANOVA tests are always bi-directional</code></pre><pre><code class="language-julia hljs"># Force an approximate test with 5000 random permutations
tapprox = fMcTestRM([vcat(yvec...) for yvec in Yvec], (n=N, k=K); 
            switch2rand=1, nperm=5000)

# in method (2) only the way the input data is formatted is different 
 
t2 = fMcTestRM(Yvec)
println(sum(abs.(t.p - t2.p)) ≈ 0. ? &quot;OK&quot; : &quot;error&quot;)
println(sum(abs.(t.obsstat - t2.obsstat)) ≈ 0. ? &quot;OK&quot; : &quot;error&quot;)

</code></pre><p><strong>Similar tests</strong></p><p>See <a href="../univariate tests/#PermutationTests.anovaTestRM"><code>anovaTestRM</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L784-L853">source</a></section></article><hr/><h2 id="Cochran-Q-test"><a class="docs-heading-anchor" href="#Cochran-Q-test">Cochran Q test</a><a id="Cochran-Q-test-1"></a><a class="docs-heading-anchor-permalink" href="#Cochran-Q-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.cochranqMcTest" href="#PermutationTests.cochranqMcTest"><code>PermutationTests.cochranqMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function cochranqMcTest(tables::AbstractVector{Matrix{I}};
            direction::TestDir = Both(),
            switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            #
            stepdown::Bool = true,
            fwe::Float64 = 0.05,
            threaded::Bool = Threads.nthreads()&gt;=4) 
                where {I &lt;: Int, TestDir &lt;: TestDirection}</code></pre><p>Multiple comparisons <a href="https://en.wikipedia.org/wiki/Cochran&#39;s_Q_test">Cochran Q</a> by data permutation. </p><p>The Cochran Q test is analogous to the 1-way ANOVA for repeated measures, but takes as input dicothomous  data (zeros and ones). Given <span>$M$</span> hypotheses, consisting each in <span>$N$</span> observation units  (e.g., <em>subjects</em>, <em>blocks</em>, etc.) and <span>$K$</span> repeated measures (e.g., <em>treatments</em>, <em>time</em>, etc.),  the null hypotheses have form</p><p><span>$H_0(m): μ_{m1}= \ldots =μ_{mk}, \quad m=1...M$</span>,</p><p>where <span>$μ_{mk}$</span> is the mean of the <span>$k^{th}$</span> treatment. </p><p>Input <code>tables</code> is a vector of <span>$M$</span> tables of zeros and ones with size <span>$NxK$</span>, where <span>$N$</span> is the number  of observations and <span>$K$</span> the repeated measures. See <a href="../univariate tests/#PermutationTests.cochranqTest"><code>cochranqTest</code></a> for more explanations.</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>. </p><p><em>Directional tests, Permutation scheme and number of permutations for exact tests:</em> as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.cochranqTest"><code>cochranqTest</code></a></p><p><em>Aliases:</em> <code>qMcTest</code>, <a href="#PermutationTests.mcNemarMcTest"><code>mcNemarMcTest</code></a></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
tables=[ [1 1 0; 1 0 0; 1 1 1; 1 1 0; 1 0 1; 1 1 0],
        [1 0 0; 1 1 0; 1 1 0; 1 1 1; 1 0 0; 1 0 0],
        [1 0 0; 0 0 1; 1 0 1; 1 1 0; 1 0 1; 1 0 0]];
t=qMcTest(tables) # the test with K&gt;2 can only be bi-directional</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L891-L938">source</a></section></article><hr/><h2 id="McNemar-test"><a class="docs-heading-anchor" href="#McNemar-test">McNemar test</a><a id="McNemar-test-1"></a><a class="docs-heading-anchor-permalink" href="#McNemar-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.mcNemarMcTest" href="#PermutationTests.mcNemarMcTest"><code>PermutationTests.mcNemarMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function mcNemarMcTest(same args and kwargs as `cochranqMcTest`&gt;)</code></pre><p>Actually an alias for [cochranqMcTest)(@ref).</p><p>Run <span>$M$</span> McNemar test simultaneously.</p><p>Input <code>tables</code> is a vector of <span>$M$</span> tables of zeros and ones with size <span>$Nx2$</span>, where <span>$N$</span> is the number  of observations and <span>$2$</span> the number of repeated measures. See <a href="../univariate tests/#PermutationTests.cochranqTest"><code>cochranqTest</code></a> for more explanations.</p><p><em>Univariate version:</em> <a href="../univariate tests/#PermutationTests.mcNemarTest"><code>mcNemarTest</code></a></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
tables=[[1 1; 1 0; 1 0; 0 0; 1 0; 1 0],
        [1 0; 1 1; 1 0; 0 1; 0 0; 1 0],
        [0 1; 0 0; 1 0; 1 0; 1 0; 1 1]];
t=mcNemarMcTest(tables) # by default the test is bi-directional

tR=mcNemarMcTest(tables; direction=Right()) # right-directional test</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L959-L984">source</a></section></article><hr/><h2 id="One-sample-Student&#39;s-t-test"><a class="docs-heading-anchor" href="#One-sample-Student&#39;s-t-test">One-sample Student&#39;s t-test</a><a id="One-sample-Student&#39;s-t-test-1"></a><a class="docs-heading-anchor-permalink" href="#One-sample-Student&#39;s-t-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentMcTest1S" href="#PermutationTests.studentMcTest1S"><code>PermutationTests.studentMcTest1S</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function studentMcTest1S(Y::UniDataVec;
            refmean::Realo = nothing,
            direction::TestDir = Both(),
            switch2rand::Int = max(Int(1e8) ÷ length(𝐘), Int(1e4)),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            #
            stepdown::Bool = true,
            fwe::Float64 = 0.05,
            threaded::Bool = Threads.nthreads()&gt;=4) where TestDir &lt;: TestDirection </code></pre><p>Multiple comparison <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test#One-sample_t-test">one-sample t-test</a>  by data permutation. </p><p>Run <span>$M$</span> one-sample t-tests simultaneously. The null hypotheses have form </p><p><span>$H_0(m): μ_m=μ_0, \quad m=1...M$</span>,</p><p>where <span>$μ_m$</span> is the mean of the observations for the <span>$m^{th}$</span> hypothesis and <span>$μ_{0}$</span> is a reference  population mean.</p><p><code>refmean</code> is the reference mean (<span>$μ_0$</span>) above. The default is <code>0.0</code>, which is the value needed in most situations.</p><p><code>Y</code> is a vector of <span>$M$</span> vectors holding each the <span>$N$</span> observations which mean is to be compared to <span>$μ_0$</span>.</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>. </p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <em>univariate version</em> <a href="../univariate tests/#PermutationTests.studentTest1S"><code>studentTest1S</code></a></p><p><em>Alias:</em> <code>tMcTest1S</code> </p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=20 # number of observations
M=100 # number of hypotheses
Y = [randn(N) for m=1:M]; # some random Gaussian data for example
t = tMcTest1S(Y) # By deafult the test is bi-directional

tR = tMcTest1S(Y; direction=Right()) # right-directional test
tL = tMcTest1S(Y; direction=Left()) # Left-directional test

# Force an approximate test with 5000 random permutations
tapprox = tMcTest1S(Y; switch2rand=1, nperm=5000) 

# test H0m: μ(ym)=1.5: all will be rejected as the expected mean is 0.0
t1 = tMcTest1S(Y; refmean=1.5) </code></pre><p><strong>Similar tests</strong></p><p>See <a href="../univariate tests/#PermutationTests.studentTest1S"><code>studentTest1S</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L989-L1049">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentMcTest1S!" href="#PermutationTests.studentMcTest1S!"><code>PermutationTests.studentMcTest1S!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function studentMcTest1S!(&lt;same args and kwargs as `studentMcTest1S`&gt;)</code></pre><p>As <a href="#PermutationTests.studentMcTest1S"><code>studentMcTest1S</code></a>, but <code>Y</code> is overwritten in the case of approximate (random permutations) tests.</p><p><em>Alias:</em> <code>tMcTest1S</code> </p><p>Univariate version: <a href="../univariate tests/#PermutationTests.studentTest1S!"><code>studentTest1S!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L1074-L1085">source</a></section></article><hr/><h2 id="Sign-test"><a class="docs-heading-anchor" href="#Sign-test">Sign test</a><a id="Sign-test-1"></a><a class="docs-heading-anchor-permalink" href="#Sign-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.signMcTest" href="#PermutationTests.signMcTest"><code>PermutationTests.signMcTest</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function signMcTest(Y::Union{AbstractVector{BitVector}, AbstractVector{Vector{Bool}}};
            direction::TestDir = Both(),
            switch2rand::Int= max(Int(1e8) ÷ length(𝐘), Int(1e4)),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            #
            stepdown::Bool = true,
            fwe::Float64 = 0.05,
            threaded::Bool = Threads.nthreads()&gt;=4) where TestDir &lt;: TestDirection
</code></pre><p>Multiple comparisons <a href="https://en.wikipedia.org/wiki/Sign_test">sign test</a> by data permutation. </p><p>Run <span>$M$</span> sign tests simultaneously.The null hypotheses have form </p><p><span>$H_0(m): E_m(true)=E_m(false), \quad m=1...M$</span>,</p><p>where <span>$E_m(true)$</span> and <span>$E_m(false)$</span> are the expected number of true and false occurrences, respectively, in the <span>$m^{th}$</span> hypothesis.</p><p><code>Y</code> ia a vector of <span>$M$</span> vectors holding each <span>$N$</span> booleans.</p><p>For optional keyword arguments, <code>direction</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code>, <code>verbose</code>, <code>stepdown</code>, <code>fwe</code> and <code>threaded</code> see <a href="#Common-kwargs-for-multiple-comparisons-tests">here</a>. </p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per  <em>univariate version</em> <a href="../univariate tests/#PermutationTests.signTest"><code>signTest</code></a></p><p>Return a <a href="../PermutationTests/#MultcompTest">MultcompTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=20; # number of observations
M=100; # number of hypotheses
Y = [rand(Bool, N) for m=1:M]; # some random Gaussian data for example
t = signMcTest(Y) # By deafult the test is bi-directional

tR = signMcTest(Y; direction=Right()) # right-directional test
tL = signMcTest(Y; direction=Left()) # Left-directional test

# Force an approximate test with 5000 random permutations
tapprox = signMcTest(Y; switch2rand=1, nperm=5000) </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/e8d2f6c1aa4f9782ffdd8b426bd60c76d171782e/src/multcompTests_API.jl#L1109-L1158">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../univariate tests/">« Univariate tests</a><a class="docs-footer-nextpage" href="../package tests/">Package tests »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Friday 27 June 2025 12:49">Friday 27 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
