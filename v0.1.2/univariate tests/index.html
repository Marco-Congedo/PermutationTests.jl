<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Univariate tests · PermutationTests</title><meta name="title" content="Univariate tests · PermutationTests"/><meta property="og:title" content="Univariate tests · PermutationTests"/><meta property="twitter:title" content="Univariate tests · PermutationTests"/><meta name="description" content="Documentation for PermutationTests."/><meta property="og:description" content="Documentation for PermutationTests."/><meta property="twitter:description" content="Documentation for PermutationTests."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="PermutationTests logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="PermutationTests logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PermutationTests</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PermutationTests.jl</a></li><li><a class="tocitem" href="../about/">About</a></li><li><a class="tocitem" href="../PermutationTests/">Main Module</a></li><li class="is-active"><a class="tocitem" href>Univariate tests</a><ul class="internal"><li><a class="tocitem" href="#Correlation-test"><span>Correlation test</span></a></li><li><a class="tocitem" href="#Trend-test"><span>Trend test</span></a></li><li><a class="tocitem" href="#Point-bi-serial-correlation-test"><span>Point bi-serial correlation test</span></a></li><li><a class="tocitem" href="#Student&#39;s-t-test-for-independent-samples"><span>Student&#39;s t-test for independent samples</span></a></li><li><a class="tocitem" href="#1-way-ANOVA-for-independent-samples"><span>1-way ANOVA for independent samples</span></a></li><li><a class="tocitem" href="#Chi-squared-test"><span>Chi-squared test</span></a></li><li><a class="tocitem" href="#Fisher-exact-test"><span>Fisher exact test</span></a></li><li><a class="tocitem" href="#Student&#39;s-t-test-for-repeated-measures"><span>Student&#39;s t-test for repeated measures</span></a></li><li><a class="tocitem" href="#1-way-ANOVA-for-repeated-measures"><span>1-way ANOVA for repeated measures</span></a></li><li><a class="tocitem" href="#Cochran-Q-test"><span>Cochran Q test</span></a></li><li><a class="tocitem" href="#McNemar-test"><span>McNemar test</span></a></li><li><a class="tocitem" href="#One-sample-Student&#39;s-t-test"><span>One-sample Student&#39;s t-test</span></a></li><li><a class="tocitem" href="#Sign-test"><span>Sign test</span></a></li></ul></li><li><a class="tocitem" href="../multiple comparisons tests/">Multiple comparisons tests</a></li><li><a class="tocitem" href="../package tests/">Package tests</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="../statistics/">Statistics</a></li><li><a class="tocitem" href="../test statistics/">Test statistics</a></li><li><a class="tocitem" href="../create your own test/">Create your own test</a></li><li><a class="tocitem" href="../chose a test/">Chose a Test</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Univariate tests</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Univariate tests</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/PermutationTests.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/master/docs/src/univariate tests.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Univariate-tests"><a class="docs-heading-anchor" href="#Univariate-tests">Univariate tests</a><a id="Univariate-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-tests" title="Permalink"></a></h1><p>They are used when a single null hypothesis is to be tested. The following tests are available.</p><hr/><h4 id="Univariate-test-functions"><a class="docs-heading-anchor" href="#Univariate-test-functions">Univariate test functions</a><a id="Univariate-test-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-test-functions" title="Permalink"></a></h4><table><tr><th style="text-align: left">Test</th><th style="text-align: left">Function</th><th style="text-align: left">Alias</th></tr><tr><td style="text-align: left">Pearson correlation</td><td style="text-align: left"><a href="#PermutationTests.correlationTest"><code>correlationTest</code></a></td><td style="text-align: left"><code>rTest</code></td></tr><tr><td style="text-align: left">Trend correlation</td><td style="text-align: left"><a href="#PermutationTests.trendTest"><code>trendTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Point bi-serial correlation</td><td style="text-align: left"><a href="#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Student&#39;s t for independent samples</td><td style="text-align: left"><a href="#PermutationTests.studentTestIS"><code>studentTestIS</code></a></td><td style="text-align: left"><code>tTestIS</code></td></tr><tr><td style="text-align: left">1-way ANOVA for independent samples</td><td style="text-align: left"><a href="#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a></td><td style="text-align: left"><code>fTestIS</code></td></tr><tr><td style="text-align: left">Chi-squared</td><td style="text-align: left"><a href="#PermutationTests.chiSquaredTest"><code>chiSquaredTest</code></a></td><td style="text-align: left"><code>Χ²Test</code></td></tr><tr><td style="text-align: left">Fisher exact</td><td style="text-align: left"><a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Student&#39;s t for repeated measures</td><td style="text-align: left"><a href="#PermutationTests.studentTestRM"><code>studentTestRM</code></a></td><td style="text-align: left"><code>tTestRM</code></td></tr><tr><td style="text-align: left">1-way ANOVA for repeated measures</td><td style="text-align: left"><a href="#PermutationTests.anovaTestRM"><code>anovaTestRM</code></a></td><td style="text-align: left"><code>fTestRM</code></td></tr><tr><td style="text-align: left">Cochran Q</td><td style="text-align: left"><a href="#PermutationTests.cochranqTest"><code>cochranqTest</code></a></td><td style="text-align: left"><code>qTest</code></td></tr><tr><td style="text-align: left">McNemar</td><td style="text-align: left"><a href="#PermutationTests.mcNemarTest"><code>mcNemarTest</code></a></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">One-sample Student&#39;s t</td><td style="text-align: left"><a href="#PermutationTests.studentTest1S"><code>studentTest1S</code></a></td><td style="text-align: left"><code>tTest1S</code></td></tr><tr><td style="text-align: left">Sign</td><td style="text-align: left"><a href="#PermutationTests.signTest"><code>signTest</code></a></td><td style="text-align: left"></td></tr></table><hr/><p>For creating other tests, see <a href="../create your own test/#Create-your-own-test">Create your own test</a>.</p><p>For multiple comparisons tests, see <a href="../multiple comparisons tests/#Multiple-comparisons-tests">Multiple comparisons tests</a>.</p><hr/><h4 id="Common-kwargs-for-univariate-tests"><a class="docs-heading-anchor" href="#Common-kwargs-for-univariate-tests">Common kwargs for univariate tests</a><a id="Common-kwargs-for-univariate-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Common-kwargs-for-univariate-tests" title="Permalink"></a></h4><p>The following optional keyword arguments are common to all univariate test functions:</p><ul><li><code>direction</code>: an instance of <a href="../PermutationTests/#TestDirection">TestDirection</a>, either <code>Right()</code>, <code>Left()</code> or <code>Both()</code>. The default is <code>Both()</code>. </li><li><code>equivalent</code>: a boolean. If <code>true</code> (default), the fastest equivalent statistic will be used. See <a href="../PermutationTests/#Statistic">Statistic</a>. </li><li><code>nperm</code>: an integer providing the number of random permutations to be used for an approximate test. It defaults to <code>20000</code>. </li><li><code>switch2rand</code>: an integer setting the upper limit of permutations to be listed exhaustively. It defaults to <code>1e8</code>. If the number of possible permutations exceeds <code>switch2rand</code>, the approximate test with <code>nperm</code> random permutations will be performed, otherwise an exact test with all possible permutations will be performed. In order to force an approximate test, set <code>switch2rand</code> to a small integer such as <code>1</code>. In order to know in advance the number of possible permutations, see <a href="../tools/#PermutationTests.nrPerms"><code>nrPerms</code></a>. </li><li><code>seed</code>: an integer. It applies only to approximate tests. Set to <code>0</code> to use a random seed for generating random permutations. Any natural number results instead in a reproducible test. It defaults to <code>1234</code>. </li><li><code>verbose</code>: a boolean. Print some information in the REPL while running the test. Set to false if you run benchmarks. The default is <code>true</code>.</li></ul><hr/><h4 id="Univariate-tests-API"><a class="docs-heading-anchor" href="#Univariate-tests-API">Univariate tests API</a><a id="Univariate-tests-API-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-tests-API" title="Permalink"></a></h4><h2 id="Correlation-test"><a class="docs-heading-anchor" href="#Correlation-test">Correlation test</a><a id="Correlation-test-1"></a><a class="docs-heading-anchor-permalink" href="#Correlation-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.correlationTest" href="#PermutationTests.correlationTest"><code>PermutationTests.correlationTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function correlationTest(x::UniData, y::UniData;
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8), 
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            standardized::Bool = false, 
            centerd::Bool = false,
            verbose::Bool = true) where TestDir &lt;: TestDirection</code></pre><p>Univariate <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#Testing_using_Student&#39;s_t-distribution">Pearson product-moment correlation test</a>  by data permutation. The null hypothesis has form </p><p><span>$H_0: r_{(x,y)}=0$</span>,</p><p>where <span>$r_{(x,y)}$</span> is the correlation between the two input data vectors, <code>x</code> and <code>y</code>, typically real, both holding <span>$N$</span> observations.</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>.</p><p>If <code>standardized</code> is true, both <code>x</code> and <code>y</code> are assumed standardized (zero mean and unit standard deviation). Provided that the input data is standardized, the test provides the same p-value, however it can be executed faster as in this case the cross-product is equivalent to the Pearon <em>r</em> statistic (see <a href="../PermutationTests/#Statistic">Statistic</a>).</p><p>If <code>centered</code> is true, both <code>x</code> and <code>y</code> are assumed centered (zero mean). The test provides the same p-value, however it can be executed faster if the test is bi-directional  as in this case the equivalent statistic, the covariance, reduces to the cross-product divided by N.</p><p>If neither <code>standardized</code> nor <code>centered</code> is true, the data will be standardized to execute a faster test using the cross-product as test-statistic.</p><p><em>Directional tests</em></p><ul><li>For a right-directional test, the correlation is expected to be positive. A negative correlation will result in a p-value higehr then 0.5.</li><li>For a left-directional test, the correlation is expected to be negative. A positive correlation will result in a p-value higehr then 0.5.</li></ul><p><em>Permutation scheme:</em> under the null hypothesis, the position of the observations in the data input vectors bears no meaning. The exchangeability scheme consists then in shuffling the observations of vector <code>x</code> or vector <code>y</code>. <em>PermutationTests.jl</em> shuffles the observations in <code>x</code>. </p><p><em>Number of permutations for exact tests:</em> there are <span>$N!$</span> possible ways of reordering the <span>$N$</span> observations in <code>x</code>.</p><p><em>Aliases:</em> <code>rTest!</code>, <a href="#PermutationTests.trendTest!"><code>trendTest!</code></a></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.correlationMcTest!">correlationMcTest!</a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=10 # number of observations
x, y = randn(N), randn(N) # some random Gaussian data for example
t = rTest(x, y) # by deafult the test is bi-directional</code></pre><pre><code class="language- hljs">tR = rTest(x, y; direction=Right()) # right-directional test
tL = rTest(x, y; direction=Left()) # Left-directional test
# Force an approximate test with 5000 random permutations
tapprox = rTest(x, y; switch2rand=1, nperm=5000) </code></pre><p><strong>Similar tests</strong></p><p>Typically, the input data is real, but can also be of type integer or boolean. If either <code>x</code> or <code>y</code> is a vector  of booleans or a vector of dicothomous data (only 0 and 1), this function will actually perform a permutation-based  version of the <a href="https://en.wikipedia.org/wiki/Point-biserial_correlation_coefficient">point bi-serial correlation test</a>. However, as shown in the preceeding link, the point bi-serial correlation test is equivalent to  the t-test for independent sample, thus it can be tested using the t-test for independent samples, which will need many less permutations as compared to a correlation test (see examples below). A dedicated function in available with name <a href="#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a>,</p><p>If <code>x</code> or <code>y</code> represent a <em>trend</em>, for example a linear trend given by <code>[1, 2,...N]</code>,  we otain the permutation-based trend correlation test, which can be used to test the fit of any type of regression of <code>y</code> on <code>x</code> - see <a href="#PermutationTests.trendTest">trendTest</a>.    </p><p>if <code>y</code> is a shifted version of <code>x</code> with a lag <span>$l$</span>, this function will test the significance of the  <em>autocorrelation</em> at lag <span>$l$</span>, similarly to the  <a href="https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic">Durbin-Watson test</a> (make sure <code>x</code> and <code>y</code>  hold the same number of elements).</p><p>if <code>Y</code> holds <span>$L$</span> shifted versions of <code>x</code> at any number of lags, the multiple comparison version of this test (<a href="../multiple comparisons tests/#PermutationTests.correlationMcTest"><code>correlationMcTest</code></a>) will test simultaneously for all the <span>$L$</span> lags similarly to the <a href="https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test">Ljung-Box or Box-Pierce test</a>.</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># Point bi-serial correlation test
using PermutationTests
N=10 # number of observations
x=[0, 0, 0, 0, 1, 1, 1, 1, 1, 1]
y = rand(N)
t = rTest(x, y) 

# Exactly the same test can be obtained as a t-test for independent sample,
# but much faster as for an exact test the latter needs only 210 permutations 
# while the former needs 3628800 permutations.
# This is available with a dedicated function
t2=pointBiSerialTest(y, [4, 6])
println(t.p ≈ t2.p ? &quot;OK&quot; : &quot;error&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L84-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.correlationTest!" href="#PermutationTests.correlationTest!"><code>PermutationTests.correlationTest!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function correlationTest!(&lt;same args and kwargs as `correlationTest`&gt;)</code></pre><p>As <a href="#PermutationTests.correlationTest"><code>correlationTest</code></a>, but <code>x</code> is overwritten if neither <code>standardized</code> nor <code>centered</code> is true.</p><p><em>Aliases:</em> <code>rTest!</code>, <a href="#PermutationTests.trendTest!"><code>trendTest!</code></a> </p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.correlationMcTest!">correlationMcTest!</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L206-L216">source</a></section></article><h2 id="Trend-test"><a class="docs-heading-anchor" href="#Trend-test">Trend test</a><a id="Trend-test-1"></a><a class="docs-heading-anchor-permalink" href="#Trend-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.trendTest" href="#PermutationTests.trendTest"><code>PermutationTests.trendTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function trendTest(&lt;same args and kwargs as `correlationTest`&gt;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L241-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.trendTest!" href="#PermutationTests.trendTest!"><code>PermutationTests.trendTest!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function trendTest!(&lt;same args and kwargs as `correlationTest!`&gt;)</code></pre><p>Actually aliases for <a href="#PermutationTests.correlationTest"><code>correlationTest</code></a> and <a href="#PermutationTests.correlationTest!"><code>correlationTest!</code></a>, respectively.</p><p>The two vectors <code>x</code> and <code>y</code> of <span>$N$</span> elements each are provided as data input.  <code>x</code> is a specified trend and <code>y</code> holds the observed data. A Pearson product-moment correlation test between  <code>x</code> and <code>y</code> is then carried out. </p><p><code>x</code> can hold any trend, such as linear, polynomial, exponential, logarithmic, power, trigonometric...</p><p><em>Directional tests, permutation scheme and number of permutations for exact tests:</em> as per <a href="#PermutationTests.correlationTest"><code>correlationTest</code></a></p><p>Multiple comparisons versions: <a href="../multiple comparisons tests/#PermutationTests.trendMcTest"><code>trendMcTest</code></a> and <a href="../multiple comparisons tests/#PermutationTests.trendMcTest!"><code>trendMcTest!</code></a></p><p>Both methods return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
# We are goint to test an upward linear trend
N=10
x=Float64.(collect(Base.OneTo(N))) # [1, 2, ..., N]
y=[1., 2., 4., 3., 5., 6., 7., 8., 10., 9.]
# Supposing we expect an upward linear trend, 
# hence the correlation is expected to be positive,
# we can use a right-directional test to increase the power of the test.
t = trendTest(x, y; direction=Right()) </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L248-L279">source</a></section></article><h2 id="Point-bi-serial-correlation-test"><a class="docs-heading-anchor" href="#Point-bi-serial-correlation-test">Point bi-serial correlation test</a><a id="Point-bi-serial-correlation-test-1"></a><a class="docs-heading-anchor-permalink" href="#Point-bi-serial-correlation-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.pointBiSerialTest" href="#PermutationTests.pointBiSerialTest"><code>PermutationTests.pointBiSerialTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function studentTestIS(y::UniData, ns::IntVec;
                direction::TestDir = Both(),
                equivalent::Bool = true,
                switch2rand::Int = Int(1e8),
                nperm::Int = 20_000, 
                seed::Int = 1234, 
                verbose::Bool = true,
                asPearson::Bool = true) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L408-L420">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function studentTestIS(yvec::UniDataVec; &lt;same kwargs&gt;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L440-L445">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (3)
function studentTestIS(y1::UniData, y2::UniData; &lt;same kwargs&gt;)</code></pre><p><strong>METHOD (1)</strong></p><p>Univariate <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test#Independent_(unpaired)_samples">Student&#39;s t-test for independent samples</a>  by data permutation. Given <span>$N=N1+N_2$</span> observations in two groups,  the null hypothesis has form</p><p><span>$H_0: μ_1=μ_2$</span>,</p><p>where <span>$μ_1$</span> and <span>$μ_1$</span> are the mean for group 1 and group 2, respectively. </p><p>For a bi-directional test, this t-test is equivalent to a 1-way ANOVA for two independent samples. However, in contrast to the ANOVA, it can be directional. </p><p><code>y</code> is a vector concatenaning the vector of observations in the two groups. Thus, it holds <span>$N$</span> elements.</p><p><code>ns</code> is a vector of integers holding the group numerosity (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>. </p><p>If <code>asPearson</code> is true (default), the test is run as an equivalent version of a Pearson correlation test. This is not faster in general for exact univariate tests, since the t-test needs  less permutations, but is in general advantageous for approximate tests (see the <a href="../package tests/#Benchmarks">benchmarks</a>). If your need to perform exact tests, you may want to set <code>asPearson</code> to false.</p><div class="admonition is-info"><header class="admonition-header">nota</header><div class="admonition-body"><p>If <code>asPearson</code> is true, the <code>.stat</code> field of the test result will actually be <code>CrossProd()</code>, as the data will be standardized before running the test. See <a href="#PermutationTests.correlationTest"><code>correlationTest</code></a>.</p></div></div><p><em>Directional tests</em></p><ul><li>For a right-directional test, <span>$μ_1$</span> is expected to exceed <span>$μ_2$</span>. If the opposite is true, the test will result in a p-value higehr then 0.5.</li><li>For a left-directional test, <span>$μ_2$</span> is expected to exceed <span>$μ_1$</span>. If the opposite is true, the test will result a p-value higehr then 0.5.</li></ul><p><em>Permutation scheme:</em> under the null hypothesis, the group membership of the observations bears no meaning. The exchangeability scheme consists then in reassigning the <span>$N$</span> observations in the two groups  respecting the original group numerosity. </p><p><em>Number of permutations for exact tests:</em> there are <span>$\frac{N!}{N_1 \cdot N_2}$</span> possible reassigments  of the <span>$N$</span> observations in the two groups.</p><p><em>Aliases:</em> <code>tTestIS</code>, <a href="#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.studentMcTestIS"><code>studentMcTestIS</code></a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><strong>METHOD (2)</strong></p><p>As (1), but <code>yvec</code> is a vector of 2-vectors of observations for group 1 and group 2 (see examples below).</p><p><strong>METHOD (3)</strong></p><p>As (1), but the observations are given separatedly for the two groups as two vectors <code>y1</code> and <code>y2</code> (see examples below).</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># (1)
using PermutationTests
ns=[4, 5]; # number of observations in group 1 and group 2 (N1 and N2)
y=[randn(n) for n∈ns]; # some Gaussian data as example
t = tTestIS(vcat(y...), ns) # by default the test is bi-directional

# with a bi-directional test, t is equivalent to a 1-way ANOVA for independent samples
tanova= fTestIS(vcat(y...), ns) 
println(t.p ≈ tanova.p ? &quot;OK&quot; : &quot;error&quot;)

# do not run it using the CrossProd test statistic
tcor = tTestIS(vcat(y...), ns; asPearson=false) 

# Force an approximate test with 10000 random permutations
tapprox = fTestIS(vcat(y...), ns; switch2rand=1, nperm=10000) 

tR=tTestIS(vcat(y...), ns; direction=Right()) # right-directional test
tL=tTestIS(vcat(y...), ns; direction=Left()) # left-directional test

# in method (2) only the way the input data is formatted is different 
t2 = tTestIS(y)
println(t.p ≈ t2.p ? &quot;OK&quot; : &quot;error&quot;)

# in method (3) also, only the way the input data is formatted is different 
t3 = tTestIS(y[1], y[2])
println(t.p ≈ t3.p ? &quot;OK&quot; : &quot;error&quot;)
</code></pre><p><strong>Similar tests</strong></p><p>Typically, the input data is real, but can also be of type integer or boolean. </p><p>For dicothomous data, with this function one can obtain the same p-value as the one given by the  Fisher exact test, however in this case it is more convenient to use the <a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a> function,  since it accepts contingency tables as input. </p><p>This function can also be used to perform a permutation-based point-biserial correlation test. See the dedicated function <a href="#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L469-L572">source</a></section></article><h2 id="Student&#39;s-t-test-for-independent-samples"><a class="docs-heading-anchor" href="#Student&#39;s-t-test-for-independent-samples">Student&#39;s t-test for independent samples</a><a id="Student&#39;s-t-test-for-independent-samples-1"></a><a class="docs-heading-anchor-permalink" href="#Student&#39;s-t-test-for-independent-samples" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentTestIS" href="#PermutationTests.studentTestIS"><code>PermutationTests.studentTestIS</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function studentTestIS(y::UniData, ns::IntVec;
                direction::TestDir = Both(),
                equivalent::Bool = true,
                switch2rand::Int = Int(1e8),
                nperm::Int = 20_000, 
                seed::Int = 1234, 
                verbose::Bool = true,
                asPearson::Bool = true) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L408-L420">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function studentTestIS(yvec::UniDataVec; &lt;same kwargs&gt;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L440-L445">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (3)
function studentTestIS(y1::UniData, y2::UniData; &lt;same kwargs&gt;)</code></pre><p><strong>METHOD (1)</strong></p><p>Univariate <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test#Independent_(unpaired)_samples">Student&#39;s t-test for independent samples</a>  by data permutation. Given <span>$N=N1+N_2$</span> observations in two groups,  the null hypothesis has form</p><p><span>$H_0: μ_1=μ_2$</span>,</p><p>where <span>$μ_1$</span> and <span>$μ_1$</span> are the mean for group 1 and group 2, respectively. </p><p>For a bi-directional test, this t-test is equivalent to a 1-way ANOVA for two independent samples. However, in contrast to the ANOVA, it can be directional. </p><p><code>y</code> is a vector concatenaning the vector of observations in the two groups. Thus, it holds <span>$N$</span> elements.</p><p><code>ns</code> is a vector of integers holding the group numerosity (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>. </p><p>If <code>asPearson</code> is true (default), the test is run as an equivalent version of a Pearson correlation test. This is not faster in general for exact univariate tests, since the t-test needs  less permutations, but is in general advantageous for approximate tests (see the <a href="../package tests/#Benchmarks">benchmarks</a>). If your need to perform exact tests, you may want to set <code>asPearson</code> to false.</p><div class="admonition is-info"><header class="admonition-header">nota</header><div class="admonition-body"><p>If <code>asPearson</code> is true, the <code>.stat</code> field of the test result will actually be <code>CrossProd()</code>, as the data will be standardized before running the test. See <a href="#PermutationTests.correlationTest"><code>correlationTest</code></a>.</p></div></div><p><em>Directional tests</em></p><ul><li>For a right-directional test, <span>$μ_1$</span> is expected to exceed <span>$μ_2$</span>. If the opposite is true, the test will result in a p-value higehr then 0.5.</li><li>For a left-directional test, <span>$μ_2$</span> is expected to exceed <span>$μ_1$</span>. If the opposite is true, the test will result a p-value higehr then 0.5.</li></ul><p><em>Permutation scheme:</em> under the null hypothesis, the group membership of the observations bears no meaning. The exchangeability scheme consists then in reassigning the <span>$N$</span> observations in the two groups  respecting the original group numerosity. </p><p><em>Number of permutations for exact tests:</em> there are <span>$\frac{N!}{N_1 \cdot N_2}$</span> possible reassigments  of the <span>$N$</span> observations in the two groups.</p><p><em>Aliases:</em> <code>tTestIS</code>, <a href="#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.studentMcTestIS"><code>studentMcTestIS</code></a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><strong>METHOD (2)</strong></p><p>As (1), but <code>yvec</code> is a vector of 2-vectors of observations for group 1 and group 2 (see examples below).</p><p><strong>METHOD (3)</strong></p><p>As (1), but the observations are given separatedly for the two groups as two vectors <code>y1</code> and <code>y2</code> (see examples below).</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># (1)
using PermutationTests
ns=[4, 5]; # number of observations in group 1 and group 2 (N1 and N2)
y=[randn(n) for n∈ns]; # some Gaussian data as example
t = tTestIS(vcat(y...), ns) # by default the test is bi-directional

# with a bi-directional test, t is equivalent to a 1-way ANOVA for independent samples
tanova= fTestIS(vcat(y...), ns) 
println(t.p ≈ tanova.p ? &quot;OK&quot; : &quot;error&quot;)

# do not run it using the CrossProd test statistic
tcor = tTestIS(vcat(y...), ns; asPearson=false) 

# Force an approximate test with 10000 random permutations
tapprox = fTestIS(vcat(y...), ns; switch2rand=1, nperm=10000) 

tR=tTestIS(vcat(y...), ns; direction=Right()) # right-directional test
tL=tTestIS(vcat(y...), ns; direction=Left()) # left-directional test

# in method (2) only the way the input data is formatted is different 
t2 = tTestIS(y)
println(t.p ≈ t2.p ? &quot;OK&quot; : &quot;error&quot;)

# in method (3) also, only the way the input data is formatted is different 
t3 = tTestIS(y[1], y[2])
println(t.p ≈ t3.p ? &quot;OK&quot; : &quot;error&quot;)
</code></pre><p><strong>Similar tests</strong></p><p>Typically, the input data is real, but can also be of type integer or boolean. </p><p>For dicothomous data, with this function one can obtain the same p-value as the one given by the  Fisher exact test, however in this case it is more convenient to use the <a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a> function,  since it accepts contingency tables as input. </p><p>This function can also be used to perform a permutation-based point-biserial correlation test. See the dedicated function <a href="#PermutationTests.pointBiSerialTest"><code>pointBiSerialTest</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L469-L572">source</a></section></article><h2 id="1-way-ANOVA-for-independent-samples"><a class="docs-heading-anchor" href="#1-way-ANOVA-for-independent-samples">1-way ANOVA for independent samples</a><a id="1-way-ANOVA-for-independent-samples-1"></a><a class="docs-heading-anchor-permalink" href="#1-way-ANOVA-for-independent-samples" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.anovaTestIS" href="#PermutationTests.anovaTestIS"><code>PermutationTests.anovaTestIS</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function anovaTestIS(y::UniData, ns::IntVec;
                direction::TestDir = Both(),
                equivalent::Bool = true,
                switch2rand::Int = Int(1e8),
                nperm::Int = 20_000, 
                seed::Int = 1234, 
                verbose::Bool = true) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L284-L295">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function anovaTestIS(yvec::UniDataVec; &lt;same kwargs&gt;)</code></pre><p><strong>METHOD (1)</strong></p><p>Univariate <a href="https://en.wikipedia.org/wiki/One-way_analysis_of_variance">1-way analysis of variance (ANOVA) for independent samples</a>  by data permutation.  Given <span>$N=N1+...+N_K$</span> observations in <span>$K$</span> groups, the null hypothesis has form</p><p><span>$H_0: μ_1= \ldots =μ_K$</span>,</p><p>where <span>$μ_k$</span> is the mean of the <span>$k^{th}$</span> group. </p><p><code>y</code> is a vector concatenaning the vector of observations in each group, in the natural order. Thus, it holds <span>$N$</span> elements. </p><p><code>ns</code> is a vector of integers holding the group numerosity (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>. </p><p><em>Directional tests</em></p><p>Not possible. The kwarg <code>direction</code> is provided only for consistency with other test functions.</p><p><em>Permutation scheme:</em> under the null hypothesis, the group membership of the observations bears no meaning. The exchangeability scheme consists then in reassigning the <span>$N$</span> observations in the <span>$K$</span> groups  respecting the original group numerosity. </p><p><em>Number of permutations for exact tests:</em> there are <span>$\frac{N!}{N_1 \cdot \ldots \cdot N_K}$</span> possible ways  of reassigning the <span>$N$</span> observations in the <span>$K$</span> groups.</p><p><strong>Alias:</strong> <code>fTestIS</code></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.anovaMcTestIS">anovaMcTestIS</a></p><p>Both methods return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><strong>METHOD (2)</strong></p><p>As (1), but <code>yvec</code> is a vector of K vectors of observations, of for each group.</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># (1)
using PermutationTests
ns=[4, 5, 6] # number of observations in group 1, 2 and 3
yvec = [randn(n) for n in ns] # some random Gaussian data for example 
t = fTestIS(vcat(yvec...), ns) # ANOVA tests are always bi-directional</code></pre><pre><code class="language-julia hljs"># Force an approximate test with 5000 random permutations
tapprox = fTestIS(vcat(yvec...), ns; switch2rand=1, nperm=5000) </code></pre><pre><code class="language-julia hljs"># in method (2) only the way the input data is formatted is different 
t2 = fTestIS(yvec)
println(t.p ≈ t2.p ? &quot;OK&quot; : &quot;error&quot;)</code></pre><p><strong>Similar tests</strong></p><p>Typically, for ANOVA the input data is real, but can also be of type integer or boolean. For dicothomous data,  with this function one can obtain a permutation-based version of the <a href="https://en.wikipedia.org/wiki/Chi-squared_test">Χ² test</a>  for <span>$K \cdot 2$</span> contingency tables, which has the ability to give exact p-values.  For <span>$2 \cdot 2$</span> contingency tables it yields exactly the same p-value of the <a href="https://en.wikipedia.org/wiki/Fisher&#39;s_exact_test">Fisher exact test</a>, which is also exact, as the name suggests. In these cases it is more convenient to use the <a href="#PermutationTests.chiSquaredTest">chiSquaredTest</a> and <a href="#PermutationTests.fisherExactTest">fisherExactTest</a> functions though,  which accept contingency tables as data input. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L311-L385">source</a></section></article><h2 id="Chi-squared-test"><a class="docs-heading-anchor" href="#Chi-squared-test">Chi-squared test</a><a id="Chi-squared-test-1"></a><a class="docs-heading-anchor-permalink" href="#Chi-squared-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.chiSquaredTest" href="#PermutationTests.chiSquaredTest"><code>PermutationTests.chiSquaredTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function chiSquaredTest(table::Matrix{I};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            asPearson::Bool = true) where {I &lt;: Int, TestDir &lt;: TestDirection}
</code></pre><p>Univariate <a href="https://en.wikipedia.org/wiki/Chi-squared_test">chi-squared</a> (<span>$\chi^2$</span>) permutation test  for <span>$2 \cdot K$</span> contingency tables, where <span>$K$</span> is ≥2.  The null hypothesis has form </p><p><span>$H_0: O=E$</span>,</p><p>where <span>$O$</span> and <span>$E$</span> are the observed and expected frequencies of the contingency table.</p><p><code>table</code> is a contingency table given in the form of a matrix of integers. For example, the contingency table</p><p>| 0 | 2 | 3 | Failures </p><p>| 3 | 1 | 0 | Successes</p><p>will be given as</p><pre><code class="language-julia hljs">table=[0 2 3; 3 1 0]</code></pre><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>.</p><p>For <span>$K=2$</span> this function calls <a href="#PermutationTests.studentTestIS"><code>studentTestIS</code></a> and pass to it also argument <code>asPearson</code>, otherwise calls <a href="#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a> and argument <code>asPearson</code> is ignored.</p><p>In contrast to Pearson&#39;s asymptotic <span>$\chi^2$</span>, with permutation tests the sample size does not have to be large. Actually, for large sample sizes Pearson&#39;s test is more efficient. For small sample sizes the p-value can be obtained  using all possible permutations, thus being exact and will be the same as the p-value obtained using  the <a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test">Fisher exact test</a>.</p><p>This permutation test is therefore not particularly useful when compared to the standard <span>$\chi^2$</span> and Fisher exact test,  however, its multiple comparison version allows the control of the family-wise error rate through data permutation. </p><p><em>Directional tests</em></p><p>Possible only for <span>$K=2$</span>, see <a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a>.</p><p><em>Permutation scheme:</em> the contingency table is converted to <span>$K$</span> vectors holding each as many observations as the corresponding column sum.  The conversion is operated internally by function <a href="../tools/#PermutationTests.table2vec"><code>table2vec</code></a>. The elements of the vectors are as many zeros and ones as the counts of the two cells of the correspondind column. The F-statistic of the 1-way ANOVA for indepedent samples is then an equivalent test-statistic for the  <span>$\chi^2$</span> and the permutation scheme of that ANOVA applies (see <a href="#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a>).</p><p><em>Number of permutations for exact tests:</em> there are <span>$\frac{N!}{N_1 \cdot\ldots\cdot N_K}$</span> possible permutations, where <span>$K$</span> is the number of columns in the contingency table and <span>$N_k$</span> is the <span>$k^{th}$</span> column sum.</p><p><em>Aliases:</em> <code>Χ²Test</code>, <a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.chiSquaredMcTest">chiSquaredMcTest</a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
table=[0 2 2; 3 1 0]
t=Χ²Test(table) # the test is bi-directional</code></pre><pre><code class="language-julia hljs">table=[6 1; 2 5]
tR=fisherExactTest(table; direction=Right()) 
# or tR=Χ²Test(table; direction=Right())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L643-L723">source</a></section></article><h2 id="Fisher-exact-test"><a class="docs-heading-anchor" href="#Fisher-exact-test">Fisher exact test</a><a id="Fisher-exact-test-1"></a><a class="docs-heading-anchor-permalink" href="#Fisher-exact-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.fisherExactTest" href="#PermutationTests.fisherExactTest"><code>PermutationTests.fisherExactTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function chiSquaredTest(table::Matrix{I};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            asPearson::Bool = true) where {I &lt;: Int, TestDir &lt;: TestDirection}
</code></pre><p>Univariate <a href="https://en.wikipedia.org/wiki/Chi-squared_test">chi-squared</a> (<span>$\chi^2$</span>) permutation test  for <span>$2 \cdot K$</span> contingency tables, where <span>$K$</span> is ≥2.  The null hypothesis has form </p><p><span>$H_0: O=E$</span>,</p><p>where <span>$O$</span> and <span>$E$</span> are the observed and expected frequencies of the contingency table.</p><p><code>table</code> is a contingency table given in the form of a matrix of integers. For example, the contingency table</p><p>| 0 | 2 | 3 | Failures </p><p>| 3 | 1 | 0 | Successes</p><p>will be given as</p><pre><code class="language-julia hljs">table=[0 2 3; 3 1 0]</code></pre><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>.</p><p>For <span>$K=2$</span> this function calls <a href="#PermutationTests.studentTestIS"><code>studentTestIS</code></a> and pass to it also argument <code>asPearson</code>, otherwise calls <a href="#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a> and argument <code>asPearson</code> is ignored.</p><p>In contrast to Pearson&#39;s asymptotic <span>$\chi^2$</span>, with permutation tests the sample size does not have to be large. Actually, for large sample sizes Pearson&#39;s test is more efficient. For small sample sizes the p-value can be obtained  using all possible permutations, thus being exact and will be the same as the p-value obtained using  the <a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test">Fisher exact test</a>.</p><p>This permutation test is therefore not particularly useful when compared to the standard <span>$\chi^2$</span> and Fisher exact test,  however, its multiple comparison version allows the control of the family-wise error rate through data permutation. </p><p><em>Directional tests</em></p><p>Possible only for <span>$K=2$</span>, see <a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a>.</p><p><em>Permutation scheme:</em> the contingency table is converted to <span>$K$</span> vectors holding each as many observations as the corresponding column sum.  The conversion is operated internally by function <a href="../tools/#PermutationTests.table2vec"><code>table2vec</code></a>. The elements of the vectors are as many zeros and ones as the counts of the two cells of the correspondind column. The F-statistic of the 1-way ANOVA for indepedent samples is then an equivalent test-statistic for the  <span>$\chi^2$</span> and the permutation scheme of that ANOVA applies (see <a href="#PermutationTests.anovaTestIS"><code>anovaTestIS</code></a>).</p><p><em>Number of permutations for exact tests:</em> there are <span>$\frac{N!}{N_1 \cdot\ldots\cdot N_K}$</span> possible permutations, where <span>$K$</span> is the number of columns in the contingency table and <span>$N_k$</span> is the <span>$k^{th}$</span> column sum.</p><p><em>Aliases:</em> <code>Χ²Test</code>, <a href="#PermutationTests.fisherExactTest"><code>fisherExactTest</code></a></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.chiSquaredMcTest">chiSquaredMcTest</a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
table=[0 2 2; 3 1 0]
t=Χ²Test(table) # the test is bi-directional</code></pre><pre><code class="language-julia hljs">table=[6 1; 2 5]
tR=fisherExactTest(table; direction=Right()) 
# or tR=Χ²Test(table; direction=Right())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L643-L723">source</a></section></article><h2 id="Student&#39;s-t-test-for-repeated-measures"><a class="docs-heading-anchor" href="#Student&#39;s-t-test-for-repeated-measures">Student&#39;s t-test for repeated measures</a><a id="Student&#39;s-t-test-for-repeated-measures-1"></a><a class="docs-heading-anchor-permalink" href="#Student&#39;s-t-test-for-repeated-measures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentTestRM" href="#PermutationTests.studentTestRM"><code>PermutationTests.studentTestRM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function studentTestRM(&lt;same args and kwargs as `studentTest1S`&gt;)</code></pre><p>Actually an alias for <a href="#PermutationTests.studentTest1S"><code>studentTest1S</code></a>.</p><p>In order to run a t-test for repeated measure, use as data input the vector of differences across measurements.</p><p>Do not change the <code>refmean</code> default value. See <a href="#PermutationTests.studentTest1S"><code>studentTest1S</code></a> for more details.</p><p><strong>Alias:</strong> <code>tTestRM</code></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.studentMcTestRM"><code>studentMcTestRM</code></a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
y1=randn(10) # measurement 1
y2=randn(10) # measurement 2
t=tTestRM(y1.-y2) #  # by default the test is bi-directional

tR=tTestRM(y1.-y2; direction=Both()) #  right-directional test
# if test tR is significant, the mean of measurement 1 exceeds the mean of measurement 2.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L1254-L1282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentTestRM!" href="#PermutationTests.studentTestRM!"><code>PermutationTests.studentTestRM!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function studentTestRM!(&lt;same args and kwargs as `studentTestRM`&gt;)</code></pre><p>Actually an alias for <a href="#PermutationTests.studentTest1S!"><code>studentTest1S!</code></a>.</p><p>See <a href="#PermutationTests.studentTestRM"><code>studentTestRM</code></a> for the usage of this function.</p><p><strong>Alias:</strong> <code>tTestRM!</code></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.studentMcTestRM!"><code>studentMcTestRM!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L1287-L1299">source</a></section></article><h2 id="1-way-ANOVA-for-repeated-measures"><a class="docs-heading-anchor" href="#1-way-ANOVA-for-repeated-measures">1-way ANOVA for repeated measures</a><a id="1-way-ANOVA-for-repeated-measures-1"></a><a class="docs-heading-anchor-permalink" href="#1-way-ANOVA-for-repeated-measures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.anovaTestRM" href="#PermutationTests.anovaTestRM"><code>PermutationTests.anovaTestRM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"># METHOD (1)
function anovaTestRM(y::UniData, ns::@NamedTuple{n::Int, k::Int};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true) where TestDir &lt;: TestDirection</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L783-L794">source</a></section><section><div><pre><code class="language-julia hljs"># METHOD (2)
function anovaTestRM(yvec::UniDataVec; &lt;same kwargs&gt;)</code></pre><p>METHOD (1)</p><p>Univariate <a href="https://en.wikipedia.org/wiki/Repeated_measures_design#Repeated_measures_ANOVA">1-way analysis of variance (ANOVA) for repeated measures</a>  by data permutation. Given <span>$N$</span> observation units (e.g., subjects, blocks, etc.) for each of <span>$K$</span> repeated measures  (e.g., treatments, time, etc.), the null hypothesis has form</p><p><span>$H_0: μ_1= \ldots =μ_K$</span>,</p><p>where <span>$μ_k$</span> is the mean of the <span>$k^{th}$</span> treatment. </p><p><code>y</code> is a vector concatenaning the observations for the <span>$K$</span> treatments in the natural order, that is, the <span>$N$</span> observation for treatment 1, ..., the <span>$N$</span> observations for treatment <span>$K$</span>. Thus, <code>y</code> holds <span>$N \cdot K$</span> elements. </p><p><code>ns</code> is a julia <a href="https://docs.julialang.org/en/v1/manual/types/#Named-Tuple-Types">named tuple</a>  with form <code>(n=N, k=K)</code> (see examples below).</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>. </p><p><em>Directional tests</em></p><p>Not possible. The kwarg <code>direction</code> is provided only for consistency with other test functions.</p><p><em>Permutation scheme:</em> under the null hypothesis, the order of the <span>$K$</span> measurements bears no meaning. The exchangeability scheme consists then in reordering the <span>$K$</span> measurements within the <span>$N$</span> observation units. </p><p><em>Number of permutations for exact tests:</em> there are <span>$K!^N$</span> possible ways of reordering the <span>$K$</span> measurements in all <span>$N$</span> observation units.</p><p><strong>Alias:</strong> <code>fTestRM</code></p><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.anovaMcTestRM">anovaMcTestRM</a></p><p>Both methods return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p>METHOD (2)</p><p>As (1), but <code>yvec</code> is a vector of K vectors holding the observations for the <span>$k^{th}$</span>  measurement (see examples below).</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># (1)
using PermutationTests
N=6; # number of observation units
K=3; # number of measurements
y = [randn(N) for k=1:K] # some random Gaussian data for example 
t = fTestRM(vcat(y...), (n=N, k=K)) # ANOVA tests are always bi-directional</code></pre><pre><code class="language-julia hljs"># Force an approximate test with 5000 random permutations
tapprox = fTestRM(vcat(y...), (n=N, k=K); switch2rand=1, nperm=5000)</code></pre><pre><code class="language-julia hljs"># in method (2) only the way the input data is formatted is different 
t2 = fTestRM(y)
println(t.p ≈ t2.p ? &quot;OK&quot; : &quot;error&quot;)</code></pre><p><strong>Similar tests</strong></p><p>Typically, the input data is real, but can also be of type integer or boolean. For dicothomous data,  with this function one can obtain the permutation-based Cochran Q test for <span>$K&gt;2$</span> and the permutation-based McNemar test  for <span>$K=2$</span>, but with the ability to give exact p-values. For these two tests the dedicated functions <a href="#PermutationTests.cochranqTest"><code>cochranqTest</code></a> and <a href="#PermutationTests.mcNemarTest"><code>mcNemarTest</code></a> is available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L817-L891">source</a></section></article><h2 id="Cochran-Q-test"><a class="docs-heading-anchor" href="#Cochran-Q-test">Cochran Q test</a><a id="Cochran-Q-test-1"></a><a class="docs-heading-anchor-permalink" href="#Cochran-Q-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.cochranqTest" href="#PermutationTests.cochranqTest"><code>PermutationTests.cochranqTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function cochranqTest(table::Matrix{I};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true) where {I &lt;: Int, TestDir &lt;: TestDirection}
</code></pre><p>Univariate <a href="https://en.wikipedia.org/wiki/Cochran&#39;s_Q_test">Cochran Q</a> test by data permutation. The Cochran Q test  is analogous to the 1-way ANOVA for repeated measures, but takes as input dicothomous data (zeros and ones). Given <span>$N$</span> observation units (e.g., subjects, blocks, etc.) and <span>$K$</span> repeated measures  (e.g., treatments, time, etc.), the null hypothesis has form</p><p><span>$H_0: μ_1= \ldots =μ_K$</span>,</p><p>where <span>$μ_k$</span> is the mean of the <span>$k^{th}$</span> measure. </p><p>When <span>$K=2$</span> the test reduces to the <a href="https://en.wikipedia.org/wiki/McNemar&#39;s_test">McNemar test</a>, which is the analogous to the Student&#39;s t-test for repeated measures taking as input dicothomous data (zeros and ones). </p><p>Input <code>table</code> is a <span>$NxK$</span> table of zeros and ones, where <span>$N$</span> is the number of observations and  <span>$K$</span> the repeated measures. Transposed, one such data would look like</p><p>| 1 | 1 | 1 | 1 | 1 | 1 | Measure 1</p><p>| 1 | 0 | 1 | 1 | 0 | 1 | Measure 2</p><p>| 0 | 0 | 1 | 0 | 1 | 0 | Measure 3</p><p>This table shall be given as input such as      <code>table=[1 1 0; 1 0 0; 1 1 1; 1 1 0; 1 0 1; 1 1 0]</code></p><p>and it will be converted to the appropriate format by function <a href="../tools/#PermutationTests.table2vec"><code>table2vec</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Redundant permutations</header><div class="admonition-body"><p>Adding any number of vectors <code>[0 0 0]</code> or <code>[1 1 1]</code> in any combination to the table here above,  yields exactly the same p-value using systematic permutations, but increase the number of permutations to be listed. If such vector exist in your data, you can delete them.</p></div></div><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>.</p><p>In contrast to the <a href="https://en.wikipedia.org/wiki/Cochran&#39;s_Q_test">Cochran Q</a> and  <a href="https://en.wikipedia.org/wiki/McNemar&#39;s_test">McNemar</a> asymptotic tests,  with permutation tests the sample size does not have to be large. Actually, for large sample sizes the Cochran Q and McNemar tests are more efficient, although they do not provide  an exact p-value (an exact test for the case <span>$K=2$</span> can be derived though). Overall, this permutation test is not very useful when compared to the standard Cochran Q and McNemar tests,  however, its multiple comparison version allows the control of the family-wise error rate by means of data permutation. </p><p><em>Directional tests</em></p><p>Possible only for <span>$K=2$</span>, see <a href="#PermutationTests.mcNemarTest"><code>mcNemarTest</code></a>. </p><p><em>Permutation scheme:</em> the F-statistic of the 1-way ANOVA for repeated measure is an equivalent test-statistic for the  Cochran Q test and the permutation scheme of that ANOVA applies (see <a href="#PermutationTests.anovaTestRM"><code>anovaTestRM</code></a>). The permutation scheme is the same for tha case of <span>$K=2$</span> (McNemar test).</p><p><em>Number of permutations for exact tests:</em> there are <span>$K!^N$</span> possible ways of reordering the <span>$K$</span> measurements in all the <span>$N$</span> observation units.</p><p><em>Aliases:</em> <code>qTest</code>, <code>mcNemarTest</code></p><p><em>Multiple comparisons versions:</em> <a href="../multiple comparisons tests/#PermutationTests.cochranqMcTest"><code>cochranqMcTest</code></a>, <a href="../multiple comparisons tests/#PermutationTests.mcNemarMcTest"><code>mcNemarMcTest</code></a> </p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
table=[1 1 0; 1 0 0; 1 1 1; 1 1 0; 1 0 1; 1 1 0]
t=qTest(table) # the test is bi-directional</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L921-L999">source</a></section></article><h2 id="McNemar-test"><a class="docs-heading-anchor" href="#McNemar-test">McNemar test</a><a id="McNemar-test-1"></a><a class="docs-heading-anchor-permalink" href="#McNemar-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.mcNemarTest" href="#PermutationTests.mcNemarTest"><code>PermutationTests.mcNemarTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function mcNemarTest(same args and kwargs as `cochranqTest`&gt;)</code></pre><p>Alias for <a href="#PermutationTests.cochranqTest"><code>cochranqTest</code></a>. It can be used for <span>$2 \cdot 2$</span> contingency tables.</p><p>Notice that <a href="#PermutationTests.cochranqTest"><code>cochranqTest</code></a> does not accept data input in the  form of a contingency table. If your data is in the form of a contingency table, here is how you can convert it:</p><p>given the contingency table</p><p>| a | b |</p><p>| c | d |</p><p>you will create a vector holding:</p><ul><li>as many vectors <code>[0, 1]</code> as the <span>$b$</span> frequency.</li><li>as many vectors <code>[1, 0]</code> as the <span>$c$</span> frequency.</li></ul><p>For example, the contingency table</p><p>| 1 | 2 |</p><p>| 3 | 4 |</p><p>will be given as input such as as</p><pre><code class="language-julia hljs">table=[0 1; 0 1; 1 0; 1 0; 1 0]</code></pre><div class="admonition is-info"><header class="admonition-header">Redundant permutations</header><div class="admonition-body"><p>Adding any number of vectors <code>[0 0]</code> or <code>[1 1]</code> in any combination to the table here above,  yields exactly the same p-value using systematic permutations. Like in the asymptotic McNemar test, these vector correspond to elements <code>a</code> and <code>d</code> of the  contingency table and have no effect.</p></div></div><p><em>Directional tests</em></p><ul><li><p>For a right-directional test, <span>$c$</span> is expected to exceed <span>$b$</span>. If the opposite is true, the test will result in a p-value higher then 0.5.</p></li><li><p>For a left-directional test, <span>$b$</span> is expected to exceed <span>$c$</span>. If the opposite is true, the test will result in a p-value higher then 0.5.</p></li></ul><p><em>Multiple comparisons version:</em> <a href="../multiple comparisons tests/#PermutationTests.mcNemarMcTest"><code>mcNemarMcTest</code></a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
table=[1 0; 1 0; 1 0; 1 0; 0 1]
t=mcNemarTest(table) # by default the test is bi-directional

tR=mcNemarTest(table; direction=Right()) # right-directional test</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L1015-L1072">source</a></section></article><h2 id="One-sample-Student&#39;s-t-test"><a class="docs-heading-anchor" href="#One-sample-Student&#39;s-t-test">One-sample Student&#39;s t-test</a><a id="One-sample-Student&#39;s-t-test-1"></a><a class="docs-heading-anchor-permalink" href="#One-sample-Student&#39;s-t-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentTest1S" href="#PermutationTests.studentTest1S"><code>PermutationTests.studentTest1S</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function studentTest1S(𝐲::UniData;
            refmean::Realo = nothing,
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true) where TestDir &lt;: TestDirection =</code></pre><p>Univariate <a href="https://en.wikipedia.org/wiki/Student&#39;s_t-test#One-sample_t-test">one-sample t-test</a>  by data permutation. The null hypothesis has form </p><p><span>$H_0: μ=μ_0$</span>,</p><p>where <span>$μ$</span> is the mean of the observations and <span>$μ_0$</span> is a reference population mean.</p><p><code>refmean</code> is the reference mean (<span>$μ_0$</span>) above. The default is <span>$0$</span>, which is the value used for most tests.</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>.</p><p><em>Directional tests</em></p><ul><li><p>For a right-directional test, <span>$μ$</span> is expected to exceeds <span>$μ_0$</span>. If the opposite is true the test will result in a p-value higehr then 0.5.</p></li><li><p>For a left-directional test, <span>$μ_0$</span> is expected to exceeds <span>$μ$</span>. If the opposite is true the test will result in a p-value higehr then 0.5.</p></li></ul><p><em>Permutation scheme:</em> the one-sample t-test test is equivalent to a t-test for two repeated measures, the mean of the difference of which  is tested by the one-sample t-test. Under the null hypothesis, the order of the two measurements bears no meaning. The exchangeability scheme consists then in reordering the two measurements in the <span>$N$</span> observation units.  For a one-sample t-test, this amounts to considering the observations with the observed and switched sign.</p><p><em>Number of permutations for exact tests:</em> there are <span>$2^N$</span> possible ways of reordering the two measurements in the <span>$N$</span> observations of <code>y</code>. For the one-sample t-test, this is the number of possible configurations of the signs of the observations.</p><p><strong>Alias:</strong> <code>tTest1S</code> </p><p>Multiple comparisons version: <a href="../multiple comparisons tests/#PermutationTests.studentMcTest1S"><code>studentMcTest1S</code></a></p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=20 # number of observations
y = randn(N) # some random Gaussian data for example
t = tTest1S(y) # test H0: μ(y)=0. By deafult the test is bi-directional

t = tTest1S(y; refmean=1.) # test H0: μ(y)=1
tR = tTest1S(y; direction=Right()) # right-directional test
tL = tTest1S(y; direction=Left()) # Left-directional test
# Force an approximate test with 5000 random permutations
tapprox = tTest1S(y; switch2rand=1, nperm=5000) </code></pre><p><strong>Similar tests</strong></p><p>Typically, the input data is real, but can also be of type integer or boolean. If either <code>y</code> is a vector  of booleans or a vector of dicothomous data (only 0 and 1), this function will actually perform a permutation-based  version of the <a href="https://en.wikipedia.org/wiki/Sign_test">sign test</a>. With boolean input, use the <a href="#PermutationTests.signTest">signTest</a> function.</p><p>Passing as data input the vector of differences of two repeated measurements, this function carries out the  Student&#39;s t-test for repeated measurements. If you need such a test you may want to use the <a href="#PermutationTests.studentTestRM"><code>studentTestRM</code></a> alias.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L1079-L1148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.studentTest1S!" href="#PermutationTests.studentTest1S!"><code>PermutationTests.studentTest1S!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function studentTest1S!(y::UniData; &lt;same args and kwargs as `studentTest1S`&gt;)</code></pre><p>As <a href="#PermutationTests.studentTest1S"><code>studentTest1S</code></a>, but <code>y</code> is overwritten in the case of approximate (random permutations) tests.</p><p><strong>Alias:</strong> <code>tTest1S!</code></p><p><strong>Multiple Comparison version:</strong> <a href="../multiple comparisons tests/#PermutationTests.studentMcTest1S!"><code>studentMcTest1S!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L1162-L1173">source</a></section></article><h2 id="Sign-test"><a class="docs-heading-anchor" href="#Sign-test">Sign test</a><a id="Sign-test-1"></a><a class="docs-heading-anchor-permalink" href="#Sign-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PermutationTests.signTest" href="#PermutationTests.signTest"><code>PermutationTests.signTest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">signTest(𝐲::Union{BitVector, Vector{Bool}};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true) where TestDir &lt;: TestDirection =
</code></pre><p><strong>Multiple comparisons version</strong></p><p><a href="../multiple comparisons tests/#PermutationTests.signMcTest"><code>signMcTest</code></a></p><p>Univariate <a href="https://en.wikipedia.org/wiki/Sign_test">sign test</a> by data permutation. The null hypothesis has form </p><p><span>$H_0: E(true)=E(false)$</span>,</p><p>where <span>$E(true)$</span> and <span>$E(false)$</span> are the expected number of true and false occurrences, respectively.</p><p><code>y</code> ia a vector of <span>$N$</span> booleans.</p><p>For optional keyword arguments, <code>direction</code>, <code>equivalent</code>, <code>switch2rand</code>, <code>nperm</code>, <code>seed</code> and <code>verbose</code>,  see <a href="#Common-kwargs-for-univariate-tests">here</a>.</p><p><em>Directional tests</em></p><ul><li>For a right-directional test, <span>$E(true)$</span> is expected to exceeds <span>$E(false)$</span>. If the opposite is true the test will result in a p-value higehr then 0.5.</li><li>For a left-directional test, <span>$E(false)$</span> is expected to exceeds <span>$E(true)$</span>. If the opposite is true the test will result in a p-value higehr then 0.5.</li></ul><p>Permutation scheme and number of permutations for exact tests: as per <a href="#PermutationTests.studentTest1S"><code>studentTest1S</code></a>. </p><p>The significance of the univariate sign test can be obtained much more efficiently using the binomial distribution. This permutation test is therefore not useful at all in the univariate case,  however, its multiple comparison version allows the control of the family-wise error rate by data permutations.</p><p>Return a <a href="../PermutationTests/#UniTest">UniTest</a> structure.</p><p><em>Examples</em></p><pre><code class="language-julia hljs">using PermutationTests
N=20; # number of observations
y = rand(Bool, N); # some random Gaussian data for example
t = signTest(y) # By deafult the test is bi-directional

tR = signTest(y; direction=Right()) # right-directional test
tL = signTest(y; direction=Left()) # Left-directional test
# Force an approximate test with 5000 random permutations
tapprox = signTest(y; switch2rand=1, nperm=5000) </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Marco-Congedo/PermutationTests.jl/blob/52dbb4475e9ca002ad02c6fc7cd811a39569f0a8/src/uniTests_API.jl#L1190-L1243">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PermutationTests/">« Main Module</a><a class="docs-footer-nextpage" href="../multiple comparisons tests/">Multiple comparisons tests »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Sunday 30 June 2024 17:40">Sunday 30 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
